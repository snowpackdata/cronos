import{h as e,r as t,c as s,a,q as l,x as n,z as i,y as o,E as r,F as c,G as d,A as u,o as m,_ as g,b as x,f as v,D as y,H as f,J as p}from"./index-2uCPEpPG.js";import"./index-8V-xrl-L.js";import{_ as b}from"./AccountDrawer-Bn-2m6Gm.js";import{A as h,_ as w,c as _}from"./AssetUploaderModal.vue_vue_type_script_setup_true_lang-0SyBpzG8.js";import{_ as k}from"./ConfirmationModal-DUMFrYPd.js";import{f as I,a as C,u as E,c as L,d as A}from"./accounts-B2EQlq8f.js";import"./XMarkIcon-Bml7Cvcl.js";import"./transition-CMIuM6C3.js";const j={class:"overflow-hidden rounded-xl border border-gray-200 bg-white shadow transition hover:shadow-md"},N={class:"flex-1"},T={class:"flex items-center gap-x-2"},D={class:"text-base font-semibold text-gray-900"},B={class:"mt-0.5 text-xs text-gray-500 ml-5"},P={key:0,class:"mt-1 text-xs text-gray-500 ml-5"},Y={key:0,class:"border-t border-gray-100 p-4 pt-3"},G={class:"grid grid-cols-1 lg:grid-cols-2 gap-x-6 gap-y-4"},F={class:"space-y-3"},M={class:"flex items-baseline"},U={class:"text-xs text-gray-900"},O={class:"flex items-baseline"},S={class:"text-xs text-gray-900"},H={class:"flex items-baseline"},R={class:"text-xs text-gray-900"},W={key:0,class:"pt-2 border-t border-gray-100"},q={class:"mt-1 text-xs text-gray-900 whitespace-pre-line"},$={key:0},K={class:"flex flex-col gap-y-1"},J={key:0,class:"flex items-center"},V={class:"inline-flex items-center rounded-md bg-sage-50 px-2 py-1 text-xs font-medium text-sage-700 ring-1 ring-inset ring-sage-600/20"},z={key:1,class:"flex items-center"},X={class:"inline-flex items-center rounded-md bg-indigo-50 px-2 py-1 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/20"},Q={class:"mt-4 grid grid-cols-1 gap-x-6 gap-y-4 border-t border-gray-100 pt-4 lg:grid-cols-2"},Z={class:"flex justify-between items-center mb-2"},ee={key:0,class:"space-y-0 divide-y divide-gray-100 border border-gray-200 rounded-lg overflow-hidden"},te={class:"min-w-0 flex-1"},se={class:"text-xs font-medium text-gray-800"},ae={key:0,class:"text-xs text-gray-500 mt-0.5"},le={class:"flex-shrink-0"},ne={key:0,class:"inline-flex items-center rounded-md bg-amber-200 px-2.5 py-1 text-xs font-semibold text-amber-800 ring-1 ring-inset ring-amber-400 shadow-sm"},ie={key:1,class:"inline-flex items-center rounded-md bg-green-200 px-2.5 py-1 text-xs font-semibold text-green-800 ring-1 ring-inset ring-green-400 shadow-sm"},oe={key:1,class:"text-xs text-gray-500 italic bg-gray-50 p-3 rounded-lg border border-gray-200 text-center"},re={class:"flex justify-between items-center mb-2"},ce={key:0,class:"space-y-2"},de={key:1,class:"text-xs text-gray-500 italic bg-gray-50 p-3 rounded-lg border border-gray-200 text-center"},ue={key:1,class:"mt-4 pt-2 border-t border-gray-100"},me=g(e({__name:"AccountCard",props:{account:{}},emits:["edit","invite-client","add-asset","asset-deleted"],setup(e,{emit:g}){const x=g,v=t(!1),y=()=>{v.value=!v.value},f=e=>{switch(e){case"BILLING_TYPE_WEEKLY":return"/wk";case"BILLING_TYPE_BIWEEKLY":return"/2wk";case"BILLING_TYPE_MONTHLY":return"/mo";case"BILLING_TYPE_BIMONTHLY":return"/2mo";case"BILLING_TYPE_PROJECT":return" total";default:return""}},p=()=>{x("asset-deleted")};return(e,t)=>{return m(),s("div",j,[a("div",{class:"flex items-start justify-between p-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:y},[a("div",N,[a("div",T,[a("i",{class:n(["fas transition-transform text-gray-400 text-xs",v.value?"fa-chevron-down":"fa-chevron-right"])},null,2),a("h3",D,i(e.account.name),1),a("span",{class:n(["inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset",e.account.projects_single_invoice?"bg-green-50 text-green-700 ring-green-600/20":"bg-amber-50 text-amber-700 ring-amber-600/20"])},i(e.account.projects_single_invoice?"Combined":"Separate"),3)]),a("p",B,i(e.account.legal_name||"No legal name provided"),1),!v.value&&e.account.client_users&&e.account.client_users.length>0?(m(),s("p",P,i(e.account.client_users.length)+" client user(s) ",1)):l("",!0)]),a("div",{class:"flex items-center space-x-2",onClick:t[1]||(t[1]=o(()=>{},["stop"]))},[a("button",{onClick:t[0]||(t[0]=t=>e.$emit("edit",e.account)),class:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 hover:bg-blue-100 transition-colors",title:"Edit Account"},t[4]||(t[4]=[a("i",{class:"fas fa-pencil-alt mr-1"},null,-1),r(" Edit ")]))])]),v.value?(m(),s("div",Y,[a("div",G,[a("div",F,[a("div",M,[t[5]||(t[5]=a("dt",{class:"text-xs font-medium text-gray-500 mr-2"},"Billing Frequency:",-1)),a("dd",U,i((x=e.account.billing_frequency,{BILLING_TYPE_WEEKLY:"Weekly",BILLING_TYPE_BIWEEKLY:"Bi-Weekly",BILLING_TYPE_MONTHLY:"Monthly",BILLING_TYPE_BIMONTHLY:"Bi-Monthly",BILLING_TYPE_PROJECT:"Project-Based"}[x]||x)),1)]),a("div",O,[t[6]||(t[6]=a("dt",{class:"text-xs font-medium text-gray-500 mr-2"},"Invoice Type:",-1)),a("dd",S,[a("span",{class:n(["inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset",e.account.projects_single_invoice?"bg-green-50 text-green-700 ring-green-600/20":"bg-amber-50 text-amber-700 ring-amber-600/20"])},i(e.account.projects_single_invoice?"Combined":"Separate"),3)])]),a("div",H,[t[7]||(t[7]=a("dt",{class:"text-xs font-medium text-gray-500 mr-2"},"Email:",-1)),a("dd",R,i(e.account.email||"Not provided"),1)]),e.account.address?(m(),s("div",W,[t[8]||(t[8]=a("dt",{class:"text-xs font-medium text-gray-500"},"Address:",-1)),a("dd",q,i(e.account.address),1)])):l("",!0)]),a("div",null,[e.account.budget_dollars||e.account.budget_hours?(m(),s("div",$,[t[11]||(t[11]=a("div",{class:"mb-2 text-xs font-medium text-gray-500"},"Budget:",-1)),a("div",K,[e.account.budget_dollars?(m(),s("div",J,[a("span",V,[t[9]||(t[9]=a("i",{class:"fas fa-dollar-sign mr-1.5"},null,-1)),r(" "+i((g=e.account.budget_dollars,g?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(g):"$0"))+i(f(e.account.billing_frequency)),1)])])):l("",!0),e.account.budget_hours?(m(),s("div",z,[a("span",X,[t[10]||(t[10]=a("i",{class:"fas fa-clock mr-1.5"},null,-1)),r(" "+i(e.account.budget_hours)+" hours"+i(f(e.account.billing_frequency)),1)])])):l("",!0)])])):l("",!0)])]),a("div",Q,[a("div",null,[a("div",Z,[t[12]||(t[12]=a("h5",{class:"text-xs font-medium text-gray-900"},"Client Users:",-1)),a("button",{type:"button",onClick:t[2]||(t[2]=o(t=>e.$emit("invite-client",e.account),["stop"])),class:"rounded bg-indigo-50 px-2 py-1 text-xs font-semibold text-indigo-600 shadow-sm hover:bg-indigo-100"}," Invite Client ")]),e.account.client_users&&e.account.client_users.length>0?(m(),s("div",ee,[(m(!0),s(c,null,d(e.account.client_users,e=>(m(),s("div",{key:e.user_id,class:"flex items-center justify-between gap-x-4 py-2.5 px-3 hover:bg-gray-50"},[a("div",te,[a("p",se,["Pending Registration"===e.status?(m(),s(c,{key:0},[r(i(e.email),1)],64)):(m(),s(c,{key:1},[r(i(e.first_name)+" "+i(e.last_name),1)],64))]),"Pending Registration"!==e.status&&e.email?(m(),s("p",ae,i(e.email),1)):l("",!0)]),a("div",le,["Pending Registration"===e.status?(m(),s("span",ne," Pending ")):"Active"===e.status?(m(),s("span",ie," Active ")):l("",!0)])]))),128))])):(m(),s("p",oe,"No client users."))]),a("div",null,[a("div",re,[t[14]||(t[14]=a("h5",{class:"text-xs font-medium text-gray-900"},"Assets:",-1)),a("button",{type:"button",onClick:t[3]||(t[3]=o(t=>e.$emit("add-asset",e.account.ID),["stop"])),class:"rounded bg-sage-50 px-2 py-1 text-xs font-semibold text-sage-700 shadow-sm hover:bg-sage-100",title:"Add File/Asset to this Account"},t[13]||(t[13]=[a("i",{class:"fas fa-plus mr-1"},null,-1),r(" Add Asset ")]))]),e.account.assets&&e.account.assets.length>0?(m(),s("div",ce,[(m(!0),s(c,null,d(e.account.assets,t=>(m(),u(h,{key:t.ID,asset:t,"account-id":e.account.ID,onDeleteAsset:p},null,8,["asset","account-id"]))),128))])):(m(),s("p",de,"No assets."))])])])):l("",!0),v.value?(m(),s("div",ue,[a("button",{onClick:y,class:"text-xs flex items-center justify-center w-full px-2 py-1.5 font-medium rounded-md bg-gray-50 text-gray-700 hover:bg-gray-100 transition-colors"},[a("span",null,i(v.value?"Hide details":"View details"),1),a("i",{class:n([v.value?"fa-chevron-up":"fa-chevron-down","fas ml-2"])},null,2)])])):l("",!0)]);var g,x}}}),[["__scopeId","data-v-77d51cf3"]]),ge={class:"px-4 py-6 sm:px-6 lg:px-8"},xe={class:"sm:flex sm:items-center"},ve={class:"mt-3 sm:ml-16 sm:mt-0 sm:flex-none"},ye={class:"mt-4 flow-root"},fe={role:"list",class:"grid grid-cols-1 gap-4"},pe={key:0,class:"col-span-full py-5"},be={key:0,class:"fixed inset-0 z-50 overflow-y-auto bg-gray-500 bg-opacity-75 transition-opacity","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},he={class:"flex min-h-full items-center justify-center p-4 text-center sm:p-0"},we={class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},_e={class:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4"},ke={class:"sm:flex sm:items-start"},Ie={class:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left"},Ce={class:"text-base font-semibold leading-6 text-gray-900",id:"modal-title"},Ee={class:"mt-2"},Le={class:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},Ae=["disabled"],je=g(e({__name:"AccountsView",setup(e){const n=t([]),o=t(!1),u=t(null),g=t(!1),h=t(null),j=t(!1),N=t(null),T=t(!1),D=t(null),B=t(""),P=x(()=>n.value.filter(e=>"ACCOUNT_TYPE_INTERNAL"!==e.type)),Y=async()=>{try{const e=await I();n.value=e||[]}catch(e){console.error("Failed to load accounts:",e),n.value=[]}};v(Y);const G=(e=null)=>{u.value=e?{...e,id:e.ID}:e,o.value=!0},F=()=>{o.value=!1,u.value=null},M=async e=>{try{if(u.value&&u.value.ID){const t={...e,ID:u.value.ID};await E(t)}else await L(e);await Y(),F()}catch(t){console.error("Failed to save account:",t)}},U=async()=>{if(h.value&&h.value.ID)try{await A(h.value.ID),await Y(),g.value=!1,h.value=null}catch(e){console.error("Failed to delete account:",e)}},O=e=>{const t=n.value.find(t=>t.ID===e);t&&(h.value=t,g.value=!0)},S=e=>{N.value=e,j.value=!0},H=()=>{j.value=!1,N.value=null},R=async e=>{try{await _(e),await Y(),H()}catch(t){console.error("Error saving asset:",t)}},W=async()=>{await Y()},q=e=>{D.value=e,B.value="",T.value=!0},$=()=>{T.value=!1,D.value=null,B.value=""},K=async()=>{if(B.value.trim()&&D.value)try{await C.inviteUser(D.value.ID,B.value),$();const e=await I();n.value=e||[]}catch(e){console.error("Failed to send invite:",e),alert(`Failed to send invite: ${e.message||"Unknown error"}`)}else alert("Please enter a valid email and ensure an account is selected.")};return(e,t)=>{var n;return m(),s("div",ge,[a("div",xe,[t[4]||(t[4]=a("div",{class:"sm:flex-auto"},[a("h1",{class:"text-base font-semibold leading-6 text-blue"},"Client Accounts"),a("p",{class:"mt-1 text-xs text-gray"},"A list of all client accounts including their contact and billing information.")],-1)),a("div",ve,[a("button",{type:"button",onClick:t[0]||(t[0]=e=>G()),class:"block rounded-md bg-sage px-2.5 py-1.5 text-center text-xs font-semibold text-white shadow-sm hover:bg-sage-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-sage"},t[3]||(t[3]=[a("i",{class:"fas fa-plus-circle mr-1"},null,-1),r(" Create new account ")]))])]),a("div",ye,[a("ul",fe,[(m(!0),s(c,null,d(P.value,e=>(m(),s("li",{key:e.ID},[y(me,{account:e,onEdit:G,onInviteClient:q,onAddAsset:S,onAssetDeleted:W},null,8,["account"])]))),128)),0===P.value.length?(m(),s("li",pe,t[5]||(t[5]=[a("div",{class:"flex flex-col items-center justify-center p-10 bg-white rounded-lg shadow"},[a("i",{class:"fas fa-building text-5xl text-gray-300 mb-4"}),a("p",{class:"text-lg font-medium text-gray-dark"},"No client accounts found"),a("p",{class:"text-gray mb-4"},'Click "Create new account" to add one')],-1)]))):l("",!0)])]),y(b,{"is-open":o.value,"account-data":u.value,onClose:F,onSave:M,onDelete:O},null,8,["is-open","account-data"]),y(w,{"is-open":j.value,"account-id":N.value,onClose:H,onSave:R},null,8,["is-open","account-id"]),y(k,{show:g.value,title:"Delete Account",message:"Are you sure you want to delete this account? This action cannot be undone and will also remove all projects associated with this account.",onConfirm:U,onCancel:t[1]||(t[1]=e=>g.value=!1)},null,8,["show"]),T.value?(m(),s("div",be,[a("div",he,[a("div",we,[a("div",_e,[a("div",ke,[t[7]||(t[7]=a("div",{class:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-indigo-100 sm:mx-0 sm:h-10 sm:w-10"},[a("i",{class:"fas fa-user-plus text-indigo-600"})],-1)),a("div",Ie,[a("h3",Ce," Invite New Client to "+i(null==(n=D.value)?void 0:n.name),1),a("div",Ee,[t[6]||(t[6]=a("p",{class:"text-sm text-gray-500"}," Enter the email address of the client you want to invite. They will receive an email to set up their account. ",-1)),f(a("input",{type:"email","onUpdate:modelValue":t[2]||(t[2]=e=>B.value=e),placeholder:"client@example.com",class:"mt-2 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,512),[[p,B.value]])])])])]),a("div",Le,[a("button",{type:"button",onClick:K,disabled:!B.value.trim(),class:"inline-flex w-full justify-center rounded-md bg-sage px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-sage-dark sm:ml-3 sm:w-auto disabled:opacity-50"}," Send Invite ",8,Ae),a("button",{type:"button",onClick:$,class:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto"}," Cancel ")])])])])):l("",!0)])}}}),[["__scopeId","data-v-06b5df47"]]);export{je as default};
