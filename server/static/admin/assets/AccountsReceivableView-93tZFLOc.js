import{N as e,h as t,r as a,f as l,b as s,c as n,a as o,q as r,H as i,J as c,I as u,L as d,z as x,E as p,F as v,G as m,x as g,y as f,o as y,_ as b}from"./index-2uCPEpPG.js";import"./index-8V-xrl-L.js";const h={getInvoices:async()=>e("invoices/accepted")}.getInvoices,w={class:"px-4 sm:px-6 lg:px-8"},k={class:"mt-4 bg-white p-4 rounded-lg shadow border border-gray-200"},I={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},_={key:0,class:"flex flex-col items-center justify-center p-10 bg-white rounded-lg shadow mt-6"},D={key:1,class:"flex flex-col items-center justify-center p-10 bg-white rounded-lg shadow mt-6"},T={class:"text-gray-600 mb-2"},E={key:2,class:"flex flex-col items-center justify-center p-10 bg-white rounded-lg shadow mt-6"},S={class:"text-gray-600 mb-4"},C={key:3,class:"mt-4 bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg"},A={key:4,class:"mt-6 bg-white shadow overflow-hidden rounded-lg border border-gray-200"},V={class:"min-w-full divide-y divide-gray-300"},O={class:"divide-y divide-gray-200 bg-white"},P=["onClick"],F={class:"py-2 pl-3 pr-2 text-sm"},N={class:"py-2 px-2 text-sm"},j={class:"font-medium text-gray-900"},$={class:"text-xs text-gray-600"},U={class:"px-2 py-2 text-sm text-gray-700"},R={class:"px-2 py-2 text-sm text-gray-700"},z={class:"px-2 py-2 text-sm font-medium text-gray-900"},L={class:"px-2 py-2 text-sm"},M={class:"flex items-center gap-2"},Y={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-bold bg-red-100 text-red-800"},q={key:0,class:"bg-gray-50"},B={colspan:"6",class:"px-3 py-3"},H={class:"bg-white rounded-lg border border-gray-200 p-3"},G={key:0,class:"mb-3 bg-red-50 border border-red-200 text-red-800 px-3 py-2 rounded text-sm"},J={class:"flex justify-between items-start mb-3"},W={class:"flex items-center gap-3"},Z=["href"],K={class:"flex gap-2"},Q=["onClick","disabled"],X=["onClick"],ee=["onClick"],te=["onClick"],ae=["onClick"],le={class:"grid grid-cols-3 gap-4 mb-3 text-sm"},se={class:"ml-2 text-gray-900"},ne={class:"ml-2 text-gray-900"},oe={key:0,class:"ml-2 text-xs font-bold text-red-700"},re={key:1},ie={class:"min-w-full text-sm"},ce={class:"divide-y divide-gray-200"},ue={class:"px-2 py-1.5 text-gray-700"},de={class:"px-2 py-1.5 text-gray-700"},xe={class:"px-2 py-1.5 text-right text-gray-700"},pe={class:"px-2 py-1.5 text-right text-gray-700"},ve={class:"px-2 py-1.5 text-right font-medium text-gray-900"},me={class:"bg-gray-50 font-semibold"},ge={class:"px-2 py-1.5 text-right text-gray-900"},fe={key:2,class:"text-sm text-gray-500 italic"},ye={key:5,class:"fixed inset-0 bg-gray-500/75 flex items-center justify-center z-50"},be={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},he={class:"px-6 py-4"},we={class:"text-xs text-gray-700 mb-4"},ke={class:"mb-4"},Ie=["max"],_e={class:"bg-gray-900 px-4 py-3 rounded-t-lg"},De={class:"flex justify-between items-center"},Te={class:"text-sm font-semibold text-white"},Ee={class:"px-4 py-3 overflow-y-auto flex-1"},Se={class:"mb-2"},Ce={class:"rounded-md bg-white outline-1 -outline-offset-1 outline-gray-300 p-1 focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-sage"},Ae={class:"flex flex-wrap gap-1 items-center"},Ve=["onClick"],Oe={class:"mb-2"},Pe={class:"rounded-md bg-white outline-1 -outline-offset-1 outline-gray-300 p-1 focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-sage"},Fe={class:"flex flex-wrap gap-1 items-center"},Ne=["onClick"],je={class:"mb-2"},$e={class:"mb-2"},Ue={class:"mb-2 flex items-center text-xs text-gray-600"},Re={class:"border-t border-gray-200 pt-2"},ze={key:0,class:"border border-gray-200 rounded-md p-3 bg-gray-50 max-h-48 overflow-y-auto"},Le={class:"bg-white p-3 rounded shadow-sm"},Me={class:"border-b border-sage pb-2 mb-2"},Ye={class:"text-xs font-semibold text-gray-600 uppercase tracking-wide mt-0.5"},qe={class:"text-xs text-gray-800 mb-2 whitespace-pre-wrap"},Be={class:"border-t border-gray-200 px-4 py-3 bg-white rounded-b-lg flex justify-between items-center"},He=["disabled"],Ge={class:"flex gap-2"},Je=["disabled"],We=b(t({__name:"AccountsReceivableView",setup(e){const t=a([]),b=a(!0),We=a(null),Ze=a(new Set),Ke=a(null),Qe=a({}),Xe=a(!1),et=a(null),tt=a((new Date).toISOString().split("T")[0]),at=a(!1),lt=a(null),st=a([]),nt=a([]),ot=a(""),rt=a(""),it=a(""),ct=a(""),ut=a(!1),dt=a(!1),xt=a({}),pt=a("all"),vt=a(""),mt=a(""),gt=a("");l(async()=>{await ft()});const ft=async()=>{b.value=!0,We.value=null;try{t.value=await h()}catch(e){console.error("Error fetching invoices:",e),We.value="Failed to load invoices. Please try again."}finally{b.value=!1}},yt=s(()=>{let e=t.value;if("all"!==pt.value&&(e=e.filter(e=>e.state===pt.value)),vt.value){const t=new Date(vt.value);e=e.filter(e=>{const a=wt(e);return a&&new Date(a)>=t})}if(mt.value){const t=new Date(mt.value);t.setHours(23,59,59,999),e=e.filter(e=>{const a=wt(e);return a&&new Date(a)<=t})}if(gt.value){const t=gt.value.toLowerCase();e=e.filter(e=>{var a;return e.invoice_number&&e.invoice_number.toLowerCase().includes(t)||e.account_name&&e.account_name.toLowerCase().includes(t)||(null==(a=e.account)?void 0:a.name)&&e.account.name.toLowerCase().includes(t)})}return e.sort((e,t)=>{const a=new Date(wt(e)||0);return new Date(wt(t)||0).getTime()-a.getTime()}),e}),bt=e=>Ze.value.has(e),ht=e=>{if(!e)return"-";if(e.startsWith("00")||"0001-01-01T00:00:00Z"===e)return"-";const t=new Date(e);return`${t.getUTCFullYear()}-${String(t.getUTCMonth()+1).padStart(2,"0")}-${String(t.getUTCDate()).padStart(2,"0")}`},wt=e=>e.date_sent?e.date_sent:e.date_approved?e.date_approved:e.accepted_at?e.accepted_at:e.period_start?e.period_start:e.date_created||"",kt=e=>{let t=(new Date).getFullYear();e.accepted_at?t=new Date(e.accepted_at).getFullYear():e.date_created&&(t=new Date(e.date_created).getFullYear());return`${t}${e.ID.toString().padStart(4,"0")}`},It=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),_t=e=>{var t,a;if(null==(t=e.project)?void 0:t.name)return e.project.name;if(e.description)return e.description;const l=(null==(a=e.account)?void 0:a.name)||e.account_name;return l?`${l} Retainer`:"Account Retainer"},Dt=e=>{switch(e){case"INVOICE_STATE_DRAFT":default:return"bg-gray-100 text-gray-700";case"INVOICE_STATE_APPROVED":return"bg-blue-100 text-blue-700";case"INVOICE_STATE_SENT":return"bg-yellow-100 text-yellow-700";case"INVOICE_STATE_PAID":return"bg-green-100 text-green-700";case"INVOICE_STATE_VOID":return"bg-red-100 text-red-700"}},Tt=e=>{if("INVOICE_STATE_PAID"===e.state||"INVOICE_STATE_VOID"===e.state||"INVOICE_STATE_DRAFT"===e.state)return!1;const t=e.date_due||e.due_at;if(!t||t.startsWith("00")||"0001-01-01T00:00:00Z"===t)return!1;const a=new Date(t),l=new Date;return l.setHours(0,0,0,0),a<l},Et=e=>{const t=e.date_due||e.due_at;if(!t||t.startsWith("00")||"0001-01-01T00:00:00Z"===t)return 0;const a=new Date(t),l=new Date;l.setHours(0,0,0,0);const s=l.getTime()-a.getTime();return Math.ceil(s/864e5)},St=()=>{pt.value="all",vt.value="",mt.value="",gt.value=""},Ct=()=>{Xe.value=!1,et.value=null},At=async()=>{if(!et.value)return;const e=et.value;Qe.value[e.ID]=null;try{const t=localStorage.getItem("snowpack_token"),a=await fetch(`/api/invoices/${e.ID}/paid`,{method:"POST",headers:{"Content-Type":"application/json","x-access-token":t||""},body:JSON.stringify({payment_date:tt.value})});if(!a.ok)throw new Error(`Failed to mark invoice as paid: ${a.statusText}`);Ke.value=`Invoice #${kt(e)} marked as paid on ${tt.value}`,Xe.value=!1,et.value=null,await ft(),setTimeout(()=>{Ke.value=null},3e3)}catch(t){console.error("Error marking invoice as paid:",t),Qe.value[e.ID]=t instanceof Error?t.message:"Failed to mark invoice as paid",Xe.value=!1}},Vt=()=>{const e=ot.value.trim();e&&!st.value.includes(e)&&(st.value.push(e),ot.value="")},Ot=e=>{st.value.splice(e,1)},Pt=()=>{const e=rt.value.trim();e&&!nt.value.includes(e)&&(nt.value.push(e),rt.value="")},Ft=e=>{nt.value.splice(e,1)},Nt=e=>{"Enter"===e.key||","===e.key||" "===e.key?(e.preventDefault(),Vt()):"Backspace"===e.key&&!ot.value&&st.value.length>0&&Ot(st.value.length-1)},jt=e=>{"Enter"===e.key||","===e.key||" "===e.key?(e.preventDefault(),Pt()):"Backspace"===e.key&&!rt.value&&nt.value.length>0&&Ft(nt.value.length-1)},$t=async()=>{if(!lt.value)return;const e=lt.value;Qe.value[e.ID]=null,ut.value=!0;try{const t=localStorage.getItem("snowpack_token"),a=await fetch(`/api/invoices/${e.ID}/send_email`,{method:"POST",headers:{"Content-Type":"application/json","x-access-token":t||""},body:JSON.stringify({to:st.value.join(","),cc:nt.value.join(","),subject:it.value,body:ct.value})});if(!a.ok){const e=await a.json();throw new Error(e.error||"Failed to send email")}Ke.value=`Invoice #${kt(e)} sent via email`,at.value=!1,await ft(),setTimeout(()=>{Ke.value=null},3e3)}catch(t){console.error("Error sending invoice email:",t),Qe.value[e.ID]=t instanceof Error?t.message:"Failed to send email"}finally{ut.value=!1}},Ut=async()=>{if(!lt.value)return;const e=lt.value;Qe.value[e.ID]=null;try{const t=localStorage.getItem("snowpack_token"),a=await fetch(`/api/invoices/${e.ID}/send`,{method:"POST",headers:{"Content-Type":"application/json","x-access-token":t||""}});if(!a.ok)throw new Error(`Failed to mark invoice as sent: ${a.statusText}`);Ke.value=`Invoice #${kt(e)} marked as sent`,at.value=!1,await ft(),setTimeout(()=>{Ke.value=null},3e3)}catch(t){console.error("Error marking invoice as sent:",t),Qe.value[e.ID]=t instanceof Error?t.message:"Failed to mark as sent"}},Rt=()=>{at.value=!1,lt.value=null,st.value=[],nt.value=[],ot.value="",rt.value="",it.value="",ct.value=""},zt=async e=>{Qe.value[e.ID]=null,xt.value[e.ID]=!0;try{const t=localStorage.getItem("snowpack_token"),a=await fetch(`/api/invoices/${e.ID}/regenerate_pdf`,{method:"POST",headers:{"Content-Type":"application/json","x-access-token":t||""}});if(!a.ok)throw new Error(`Failed to regenerate PDF: ${a.statusText}`);Ke.value=`Invoice #${kt(e)} PDF regenerated successfully`,await ft(),setTimeout(()=>{Ke.value=null},3e3)}catch(t){console.error("Error regenerating PDF:",t),Qe.value[e.ID]=t instanceof Error?t.message:"Failed to regenerate PDF"}finally{xt.value[e.ID]=!1}};return(e,a)=>{var l,s;return y(),n("div",w,[a[51]||(a[51]=o("div",{class:"sm:flex sm:items-center"},[o("div",{class:"sm:flex-auto"},[o("h1",{class:"text-xl font-semibold text-gray-900"},"Accounts Receivable"),o("p",{class:"mt-2 text-sm text-gray-700"},"A list of all invoices including their status, amount, and line item details.")])],-1)),o("div",k,[o("div",I,[o("div",null,[a[11]||(a[11]=o("label",{for:"search",class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),i(o("input",{id:"search","onUpdate:modelValue":a[0]||(a[0]=e=>gt.value=e),type:"text",placeholder:"Invoice # or Client...",class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,gt.value]])]),o("div",null,[a[13]||(a[13]=o("label",{for:"state",class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),i(o("select",{id:"state","onUpdate:modelValue":a[1]||(a[1]=e=>pt.value=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},a[12]||(a[12]=[d('<option value="all" data-v-8d2157a5>All</option><option value="INVOICE_STATE_DRAFT" data-v-8d2157a5>Draft</option><option value="INVOICE_STATE_APPROVED" data-v-8d2157a5>Approved</option><option value="INVOICE_STATE_SENT" data-v-8d2157a5>Sent</option><option value="INVOICE_STATE_PAID" data-v-8d2157a5>Paid</option><option value="INVOICE_STATE_VOID" data-v-8d2157a5>Void</option>',6)]),512),[[u,pt.value]])]),o("div",null,[a[14]||(a[14]=o("label",{for:"start-date",class:"block text-sm font-medium text-gray-700 mb-1"},"Start Date",-1)),i(o("input",{id:"start-date","onUpdate:modelValue":a[2]||(a[2]=e=>vt.value=e),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,vt.value]])]),o("div",null,[a[15]||(a[15]=o("label",{for:"end-date",class:"block text-sm font-medium text-gray-700 mb-1"},"End Date",-1)),i(o("input",{id:"end-date","onUpdate:modelValue":a[3]||(a[3]=e=>mt.value=e),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,mt.value]])])]),o("div",{class:"mt-3 flex justify-end"},[o("button",{onClick:St,class:"text-sm text-gray-600 hover:text-gray-900"}," Clear Filters ")])]),b.value?(y(),n("div",_,a[16]||(a[16]=[o("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"},null,-1),o("span",{class:"text-gray-600"},"Loading invoices...",-1)]))):We.value?(y(),n("div",D,[a[18]||(a[18]=o("i",{class:"fas fa-exclamation-circle text-4xl text-red-600 mb-4"},null,-1)),o("span",T,x(We.value),1),o("button",{onClick:ft,class:"btn-secondary mt-4"},a[17]||(a[17]=[o("i",{class:"fas fa-sync mr-2"},null,-1),p(" Retry ")]))])):0===yt.value.length?(y(),n("div",E,[a[19]||(a[19]=o("i",{class:"fas fa-file-invoice-dollar text-5xl text-blue-600 mb-4"},null,-1)),a[20]||(a[20]=o("p",{class:"text-lg font-medium text-gray-700"},"No invoices found",-1)),o("p",S,x(0===t.value.length?"Invoices will appear here once they are created":"Try adjusting your filters"),1),t.value.length>0?(y(),n("button",{key:0,onClick:St,class:"btn-secondary"}," Clear Filters ")):r("",!0)])):r("",!0),Ke.value?(y(),n("div",C,[a[21]||(a[21]=o("i",{class:"fas fa-check-circle mr-2"},null,-1)),p(x(Ke.value),1)])):(y(),n("div",A,[o("table",V,[a[36]||(a[36]=o("thead",{class:"bg-gray-50"},[o("tr",null,[o("th",{scope:"col",class:"w-10 py-2 pl-3 pr-2 text-left text-sm font-semibold text-gray-900"}),o("th",{scope:"col",class:"py-2 px-2 text-left text-sm font-semibold text-gray-900"},"Invoice"),o("th",{scope:"col",class:"px-2 py-2 text-left text-sm font-semibold text-gray-900"},"Client"),o("th",{scope:"col",class:"px-2 py-2 text-left text-sm font-semibold text-gray-900"},"Date"),o("th",{scope:"col",class:"px-2 py-2 text-left text-sm font-semibold text-gray-900"},"Amount"),o("th",{scope:"col",class:"px-2 py-2 text-left text-sm font-semibold text-gray-900"},"Status")])],-1)),o("tbody",O,[(y(!0),n(v,null,m(yt.value,e=>{var t,l;return y(),n(v,{key:e.ID},[o("tr",{onClick:t=>{return a=e.ID,void(Ze.value.has(a)?Ze.value.delete(a):Ze.value.add(a));var a},class:"hover:bg-gray-50 cursor-pointer transition-colors"},[o("td",F,[o("i",{class:g([bt(e.ID)?"fas fa-chevron-down":"fas fa-chevron-right","text-gray-400"])},null,2)]),o("td",N,[o("div",j,"#"+x(kt(e)),1),o("div",$,x(_t(e)),1)]),o("td",U,x((null==(t=e.account)?void 0:t.name)||e.account_name||"-"),1),o("td",R,x(ht(wt(e))),1),o("td",z,x(It(e.total_amount)),1),o("td",L,[o("div",M,[o("span",{class:g([Dt(e.state),"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium"])},x((l=e.state,l?l.replace("INVOICE_STATE_","").replace(/_/g," "):"Unknown")),3),Tt(e)?(y(),n("span",Y,[a[22]||(a[22]=o("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1)),p(" "+x(Et(e))+"d overdue ",1)])):r("",!0)])])],8,P),bt(e.ID)?(y(),n("tr",q,[o("td",B,[o("div",H,[Qe.value[e.ID]?(y(),n("div",G,[a[23]||(a[23]=o("i",{class:"fas fa-exclamation-circle mr-2"},null,-1)),p(x(Qe.value[e.ID]),1)])):r("",!0),o("div",J,[o("div",W,[a[25]||(a[25]=o("h4",{class:"text-sm font-semibold text-gray-900"},"Invoice Details",-1)),e.file?(y(),n("a",{key:0,href:e.file,target:"_blank",class:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1"},a[24]||(a[24]=[o("i",{class:"fas fa-file-pdf"},null,-1),p(" View PDF ")]),8,Z)):r("",!0)]),o("div",K,["INVOICE_STATE_APPROVED"===e.state?(y(),n("button",{key:0,onClick:f(t=>zt(e),["stop"]),disabled:xt.value[e.ID],class:"px-3 py-1 text-xs font-medium text-white bg-purple-600 hover:bg-purple-700 rounded transition-colors disabled:opacity-50",title:"Generate invoice PDF"},[o("i",{class:g(["fas",xt.value[e.ID]?"fa-spinner fa-spin":"fa-file-pdf"])},null,2),p(" "+x(xt.value[e.ID]?"Generating...":"Generate PDF"),1)],8,Q)):r("",!0),"INVOICE_STATE_APPROVED"===e.state?(y(),n("button",{key:1,onClick:f(t=>(e=>{var t,a,l;lt.value=e,st.value=(null==(t=e.account)?void 0:t.email)?[e.account.email]:[],nt.value=["accounts@snowpack-data.com"],ot.value="",rt.value="";const s=new Date(e.period_end).toLocaleDateString("en-US",{month:"long",year:"numeric"}),n=String(e.ID).padStart(6,"0");it.value=`Snowpack Data ${s} Invoice #${n}`;const o=(null==(a=e.project)?void 0:a.name)||(null==(l=e.account)?void 0:l.name)||e.account_name;ct.value=`Please see attached invoice for support on ${o} for ${ht(e.period_start)} - ${ht(e.period_end)}.\n\nDuring this period we [Enter accomplishments here]`,at.value=!0})(e),["stop"]),class:"px-3 py-1 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors"},a[26]||(a[26]=[o("i",{class:"fas fa-paper-plane mr-1"},null,-1),p(" Send ")]),8,X)):r("",!0),"INVOICE_STATE_SENT"===e.state?(y(),n("button",{key:2,onClick:f(t=>(e=>{et.value=e,tt.value=(new Date).toISOString().split("T")[0],Xe.value=!0})(e),["stop"]),class:"px-3 py-1 text-xs font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors"},a[27]||(a[27]=[o("i",{class:"fas fa-check mr-1"},null,-1),p(" Mark Paid ")]),8,ee)):r("",!0),"INVOICE_STATE_SENT"===e.state||"INVOICE_STATE_PAID"===e.state?(y(),n("button",{key:3,onClick:f(t=>zt(e),["stop"]),class:"px-3 py-1 text-xs font-medium text-white bg-purple-600 hover:bg-purple-700 rounded transition-colors",title:"Regenerate invoice PDF"},a[28]||(a[28]=[o("i",{class:"fas fa-file-pdf mr-1"},null,-1),p(" Regenerate PDF ")]),8,te)):r("",!0),"INVOICE_STATE_VOID"!==e.state&&"INVOICE_STATE_PAID"!==e.state?(y(),n("button",{key:4,onClick:f(t=>(async e=>{if(confirm(`Are you sure you want to void invoice #${kt(e)}? This action cannot be undone.`)){Qe.value[e.ID]=null;try{const t=localStorage.getItem("snowpack_token"),a=await fetch(`/api/invoices/${e.ID}/void`,{method:"POST",headers:{"Content-Type":"application/json","x-access-token":t||""}});if(!a.ok)throw new Error(`Failed to void invoice: ${a.statusText}`);Ke.value=`Invoice #${kt(e)} voided`,await ft(),setTimeout(()=>{Ke.value=null},3e3)}catch(t){console.error("Error voiding invoice:",t),Qe.value[e.ID]=t instanceof Error?t.message:"Failed to void invoice"}}})(e),["stop"]),class:"px-3 py-1 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded transition-colors"},a[29]||(a[29]=[o("i",{class:"fas fa-times mr-1"},null,-1),p(" Void ")]),8,ae)):r("",!0)])]),o("div",le,[o("div",null,[a[30]||(a[30]=o("span",{class:"text-gray-600"},"Period:",-1)),o("span",se,x(ht(e.period_start))+" - "+x(ht(e.period_end)),1)]),o("div",null,[a[31]||(a[31]=o("span",{class:"text-gray-600"},"Hours:",-1)),o("span",ne,x(e.total_hours.toFixed(2)),1)]),o("div",null,[a[32]||(a[32]=o("span",{class:"text-gray-600"},"Due Date:",-1)),o("span",{class:g(["ml-2",Tt(e)?"text-red-700 font-bold":"text-gray-900"])},x(ht(e.date_due||e.due_at)),3),Tt(e)?(y(),n("span",oe," ("+x(Et(e))+" days overdue) ",1)):r("",!0)])]),e.line_items&&e.line_items.length>0?(y(),n("div",re,[a[35]||(a[35]=o("h5",{class:"text-sm font-medium text-gray-900 mb-2"},"Line Items",-1)),o("table",ie,[a[34]||(a[34]=o("thead",{class:"bg-gray-100"},[o("tr",null,[o("th",{class:"px-2 py-1.5 text-left text-xs font-medium text-gray-600"},"Type"),o("th",{class:"px-2 py-1.5 text-left text-xs font-medium text-gray-600"},"Description"),o("th",{class:"px-2 py-1.5 text-right text-xs font-medium text-gray-600"},"Quantity"),o("th",{class:"px-2 py-1.5 text-right text-xs font-medium text-gray-600"},"Rate"),o("th",{class:"px-2 py-1.5 text-right text-xs font-medium text-gray-600"},"Amount")])],-1)),o("tbody",ce,[(y(!0),n(v,null,m(e.line_items,e=>{return y(),n("tr",{key:e.ID},[o("td",ue,x((t=e.type,t?t.replace("LINE_ITEM_TYPE_","").replace(/_/g," "):"Unknown")),1),o("td",de,x(e.description),1),o("td",xe,x(e.quantity>0?e.quantity.toFixed(2):"-"),1),o("td",pe,x(e.rate>0?It(e.rate):"-"),1),o("td",ve,x(It(e.amount/100)),1)]);var t}),128))]),o("tfoot",me,[o("tr",null,[a[33]||(a[33]=o("td",{colspan:"4",class:"px-2 py-1.5 text-right text-gray-900"},"Total",-1)),o("td",ge,x(It(e.total_amount)),1)])])])])):(y(),n("div",fe," No line items available "))])])])):r("",!0)],64)}),128))])])])),Xe.value?(y(),n("div",ye,[o("div",be,[a[39]||(a[39]=o("div",{class:"bg-sage px-6 py-4 rounded-t-lg"},[o("h3",{class:"text-sm font-semibold text-white"},"Confirm Payment Date")],-1)),o("div",he,[o("p",we," Enter the date the payment was received for Invoice #"+x(et.value?kt(et.value):""),1),o("div",ke,[a[37]||(a[37]=o("label",{class:"block text-xs font-medium text-gray-700 mb-2"},"Payment Date",-1)),i(o("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>tt.value=e),type:"date",class:"w-full px-3 py-2 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sage focus:border-transparent",max:(new Date).toISOString().split("T")[0]},null,8,Ie),[[c,tt.value]])])]),o("div",{class:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3"},[o("button",{onClick:Ct,class:"px-4 py-2 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"}," Cancel "),o("button",{onClick:At,class:"px-4 py-2 text-xs font-medium text-white bg-green-600 rounded-md hover:bg-green-700 transition-colors"},a[38]||(a[38]=[o("i",{class:"fas fa-check mr-2"},null,-1),p("Mark as Paid ")]))])])])):r("",!0),at.value?(y(),n("div",{key:6,class:"fixed inset-0 bg-gray-500/75 flex items-center justify-center z-50",onClick:Rt},[o("div",{class:"bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[92vh] flex flex-col",onClick:a[10]||(a[10]=f(()=>{},["stop"]))},[o("div",_e,[o("div",De,[o("h3",Te," Send Invoice #"+x(lt.value?kt(lt.value):""),1),o("button",{onClick:Rt,class:"text-gray-400 hover:text-gray-200 transition-colors"},a[40]||(a[40]=[o("i",{class:"fas fa-times text-lg"},null,-1)]))])]),o("div",Ee,[o("div",Se,[a[42]||(a[42]=o("label",{class:"block text-xs font-medium text-gray-700 mb-0.5"},[p("To: "),o("span",{class:"text-red-500"},"*")],-1)),o("div",Ce,[o("div",Ae,[(y(!0),n(v,null,m(st.value,(e,t)=>(y(),n("span",{key:t,class:"inline-flex items-center gap-0.5 bg-gray-200 text-gray-700 px-1.5 py-0.5 rounded text-xs"},[p(x(e)+" ",1),o("button",{onClick:e=>Ot(t),class:"hover:text-gray-900"},a[41]||(a[41]=[o("i",{class:"fas fa-times",style:{"font-size":"8px"}},null,-1)]),8,Ve)]))),128)),i(o("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>ot.value=e),onKeydown:Nt,onBlur:Vt,type:"email",placeholder:"Add email...",class:"flex-1 min-w-24 border-0 p-0 text-xs text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-0",style:{"font-size":"0.75rem","line-height":"1"}},null,544),[[c,ot.value]])])])]),o("div",Oe,[a[44]||(a[44]=o("label",{class:"block text-xs font-medium text-gray-700 mb-0.5"},"Cc:",-1)),o("div",Pe,[o("div",Fe,[(y(!0),n(v,null,m(nt.value,(e,t)=>(y(),n("span",{key:t,class:"inline-flex items-center gap-0.5 bg-gray-200 text-gray-700 px-1.5 py-0.5 rounded text-xs"},[p(x(e)+" ",1),o("button",{onClick:e=>Ft(t),class:"hover:text-gray-900"},a[43]||(a[43]=[o("i",{class:"fas fa-times",style:{"font-size":"8px"}},null,-1)]),8,Ne)]))),128)),i(o("input",{"onUpdate:modelValue":a[6]||(a[6]=e=>rt.value=e),onKeydown:jt,onBlur:Pt,type:"email",placeholder:"Add email...",class:"flex-1 min-w-24 border-0 p-0 text-xs text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-0",style:{"font-size":"0.75rem","line-height":"1"}},null,544),[[c,rt.value]])])])]),o("div",je,[a[45]||(a[45]=o("label",{class:"block text-xs font-medium text-gray-700 mb-0.5"},[p("Subject: "),o("span",{class:"text-red-500"},"*")],-1)),i(o("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>it.value=e),type:"text",required:"",class:"block w-full rounded-md bg-white py-1 px-2 text-xs text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-sage",style:{"font-size":"0.75rem","line-height":"1"}},null,512),[[c,it.value]])]),o("div",$e,[a[46]||(a[46]=o("label",{class:"block text-xs font-medium text-gray-700 mb-0.5"},[p("Message: "),o("span",{class:"text-red-500"},"*")],-1)),i(o("textarea",{"onUpdate:modelValue":a[8]||(a[8]=e=>ct.value=e),rows:"5",required:"",placeholder:"Message (fill in accomplishments before sending)",class:"block w-full rounded-md bg-white px-2 py-1 text-xs text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-sage",style:{"font-size":"0.75rem","line-height":"1.2"}},null,512),[[c,ct.value]])]),o("div",Ue,[o("i",{class:g(["fas mr-1 size-3",(null==(l=lt.value)?void 0:l.file)?"fa-paperclip text-green-600":"fa-file-pdf text-yellow-600"])},null,2),o("span",null,x((null==(s=lt.value)?void 0:s.file)?"Invoice PDF attached":"PDF will be generated on send"),1)]),o("div",Re,[o("button",{onClick:a[9]||(a[9]=e=>dt.value=!dt.value),class:"flex items-center justify-between w-full text-left text-xs font-medium text-gray-700 hover:text-gray-900 mb-1"},[a[47]||(a[47]=o("span",null,[o("i",{class:"fas fa-eye mr-1 size-3"}),p(" Email Preview ")],-1)),o("i",{class:g(["fas size-3 transition-transform",dt.value?"fa-chevron-up":"fa-chevron-down"])},null,2)]),dt.value?(y(),n("div",ze,[o("div",Le,[o("div",Me,[a[48]||(a[48]=o("h1",{class:"text-sm font-bold text-sage"},"Snowpack Data",-1)),o("p",Ye," Invoice #"+x(lt.value?String(lt.value.ID).padStart(6,"0"):""),1)]),o("div",qe,x(ct.value||"[Your message will appear here]"),1),a[49]||(a[49]=d('<div class="text-center my-2" data-v-8d2157a5><a href="#" class="inline-block px-3 py-1.5 bg-sage text-white font-semibold rounded text-xs" data-v-8d2157a5> ðŸ“„ View Invoice PDF </a></div><div class="mt-3 pt-2 border-t text-xs text-gray-600 bg-gray-50 p-2 rounded" data-v-8d2157a5><p class="font-semibold" data-v-8d2157a5>Best,</p><p class="font-semibold text-sage" data-v-8d2157a5>Snowpack Data</p><p class="text-gray-500 mt-1" data-v-8d2157a5> 2261 Market Street STE 22279<br data-v-8d2157a5> San Francisco, CA 94114<br data-v-8d2157a5><a href="mailto:billing@snowpack-data.com" class="text-sage" data-v-8d2157a5>billing@snowpack-data.com</a></p></div>',2))])])):r("",!0)])]),o("div",Be,[o("button",{onClick:Ut,disabled:ut.value,class:"text-xs text-gray-600 hover:text-gray-900 font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},a[50]||(a[50]=[o("i",{class:"fas fa-check-circle mr-1.5 size-3"},null,-1),p("Mark Sent Offline ")]),8,He),o("div",Ge,[o("button",{onClick:Rt,class:"px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"}," Cancel "),o("button",{onClick:$t,class:"px-3 py-1.5 text-xs font-medium text-white bg-sage rounded-md hover:bg-sage-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:ut.value||0===st.value.length||!it.value||!ct.value},[o("i",{class:g(["fas mr-1.5 size-3",ut.value?"fa-spinner fa-spin":"fa-paper-plane"])},null,2),p(" "+x(ut.value?"Sending...":"Send Invoice"),1)],8,Je)])])])])):r("",!0)])}}}),[["__scopeId","data-v-8d2157a5"]]);export{We as default};
