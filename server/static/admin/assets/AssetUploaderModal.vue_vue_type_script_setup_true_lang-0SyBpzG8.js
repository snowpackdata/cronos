import{T as e,h as t,r as a,b as n,c as s,a as i,x as o,y as r,z as l,q as u,o as d,_ as c,w as m,A as f,C as p,u as h,D as g,E as v,H as y,J as b,I as w,K as x}from"./index-2uCPEpPG.js";import{S as _,h as D,G as k,V as M,Y as E}from"./transition-CMIuM6C3.js";const S=6e4,T=36e5,j=43200,I=Symbol.for("constructDateFrom");function C(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&I in e?e[I](t):e instanceof Date?new e.constructor(t):new Date(t)}function N(e,t){return C(e,e)}let O={};function L(e){const t=N(e),a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return a.setUTCFullYear(t.getFullYear()),+e-+a}function A(e,...t){const a=C.bind(null,e||t.find(e=>"object"==typeof e));return t.map(a)}function W(e,t){const a=+N(e)-+N(t);return a<0?-1:a>0?1:a}function P(e,t){const a=N(e);return+function(e){const t=N(e);return t.setHours(23,59,59,999),t}(a)===+function(e){const t=N(e),a=t.getMonth();return t.setFullYear(t.getFullYear(),a+1,0),t.setHours(23,59,59,999),t}(a)}function U(e,t,a){const[n,s,i]=A(null==a?void 0:a.in,e,e,t),o=W(s,i),r=Math.abs(function(e,t,a){const[n,s]=A(null==a?void 0:a.in,e,t);return 12*(n.getFullYear()-s.getFullYear())+(n.getMonth()-s.getMonth())}(s,i));if(r<1)return 0;1===s.getMonth()&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-o*r);let l=W(s,i)===-o;P(n)&&1===r&&1===W(n,i)&&(l=!1);const u=o*(r-+l);return 0===u?0:u}function F(e,t,a){const n=function(e,t){return+N(e)-+N(t)}(e,t)/1e3;return(s=null==a?void 0:a.roundingMethod,e=>{const t=(s?Math[s]:Math.trunc)(e);return 0===t?0:t})(n);var s}const G={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function X(e){return(t={})=>{const a=t.width?String(t.width):e.defaultWidth;return e.formats[a]||e.formats[e.defaultWidth]}}const R={date:X({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:X({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:X({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},z={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Y(e){return(t,a)=>{let n;if("formatting"===((null==a?void 0:a.context)?String(a.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,s=(null==a?void 0:a.width)?String(a.width):t;n=e.formattingValues[s]||e.formattingValues[t]}else{const t=e.defaultWidth,s=(null==a?void 0:a.width)?String(a.width):e.defaultWidth;n=e.values[s]||e.values[t]}return n[e.argumentCallback?e.argumentCallback(t):t]}}function $(e){return(t,a={})=>{const n=a.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const o=i[0],r=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(r)?function(e,t){for(let a=0;a<e.length;a++)if(t(e[a]))return a;return}(r,e=>e.test(o)):function(e,t){for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&t(e[a]))return a;return}(r,e=>e.test(o));let u;u=e.valueCallback?e.valueCallback(l):l,u=a.valueCallback?a.valueCallback(u):u;return{value:u,rest:t.slice(o.length)}}}var q;const H={code:"en-US",formatDistance:(e,t,a)=>{let n;const s=G[e];return n="string"==typeof s?s:1===t?s.one:s.other.replace("{{count}}",t.toString()),(null==a?void 0:a.addSuffix)?a.comparison&&a.comparison>0?"in "+n:n+" ago":n},formatLong:R,formatRelative:(e,t,a,n)=>z[e],localize:{ordinalNumber:(e,t)=>{const a=Number(e),n=a%100;if(n>20||n<10)switch(n%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},era:Y({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Y({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:Y({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Y({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Y({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(q={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const a=e.match(q.matchPattern);if(!a)return null;const n=a[0],s=e.match(q.parsePattern);if(!s)return null;let i=q.valueCallback?q.valueCallback(s[0]):s[0];return i=t.valueCallback?t.valueCallback(i):i,{value:i,rest:e.slice(n.length)}}),era:$({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:$({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:$({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:$({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:$({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function J(e,t,a){const n=O,s=(null==a?void 0:a.locale)??n.locale??H,i=W(e,t);if(isNaN(i))throw new RangeError("Invalid time value");const o=Object.assign({},a,{addSuffix:null==a?void 0:a.addSuffix,comparison:i}),[r,l]=A(null==a?void 0:a.in,...i>0?[t,e]:[e,t]),u=F(l,r),d=(L(l)-L(r))/1e3,c=Math.round((u-d)/60);let m;if(c<2)return(null==a?void 0:a.includeSeconds)?u<5?s.formatDistance("lessThanXSeconds",5,o):u<10?s.formatDistance("lessThanXSeconds",10,o):u<20?s.formatDistance("lessThanXSeconds",20,o):u<40?s.formatDistance("halfAMinute",0,o):u<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):0===c?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",c,o);if(c<45)return s.formatDistance("xMinutes",c,o);if(c<90)return s.formatDistance("aboutXHours",1,o);if(c<1440){const e=Math.round(c/60);return s.formatDistance("aboutXHours",e,o)}if(c<2520)return s.formatDistance("xDays",1,o);if(c<j){const e=Math.round(c/1440);return s.formatDistance("xDays",e,o)}if(c<86400)return m=Math.round(c/j),s.formatDistance("aboutXMonths",m,o);if(m=U(l,r),m<12){const e=Math.round(c/j);return s.formatDistance("xMonths",e,o)}{const e=m%12,t=Math.trunc(m/12);return e<3?s.formatDistance("aboutXYears",t,o):e<9?s.formatDistance("overXYears",t,o):s.formatDistance("almostXYears",t+1,o)}}function V(e,t){return J(e,function(e){return C(e,Date.now())}(e),t)}function Z(e,t){const a=()=>C(null==t?void 0:t.in,NaN),n=function(e){const t={},a=e.split(B.dateTimeDelimiter);let n;if(a.length>2)return t;/:/.test(a[0])?n=a[0]:(t.date=a[0],n=a[1],B.timeZoneDelimiter.test(t.date)&&(t.date=e.split(B.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length)));if(n){const e=B.timezone.exec(n);e?(t.time=n.replace(e[1],""),t.timezone=e[1]):t.time=n}return t}(e);let s;if(n.date){const e=function(e,t){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(a);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:null===i?s:100*i,restDateString:e.slice((n[1]||n[2]).length)}}(n.date,2);s=function(e,t){if(null===t)return new Date(NaN);const a=e.match(K);if(!a)return new Date(NaN);const n=!!a[4],s=te(a[1]),i=te(a[2])-1,o=te(a[3]),r=te(a[4]),l=te(a[5])-1;if(n)return function(e,t,a){return t>=1&&t<=53&&a>=0&&a<=6}(0,r,l)?function(e,t,a){const n=new Date(0);n.setUTCFullYear(e,0,4);const s=n.getUTCDay()||7,i=7*(t-1)+a+1-s;return n.setUTCDate(n.getUTCDate()+i),n}(t,r,l):new Date(NaN);{const e=new Date(0);return function(e,t,a){return t>=0&&t<=11&&a>=1&&a<=(ne[t]||(se(e)?29:28))}(t,i,o)&&function(e,t){return t>=1&&t<=(se(e)?366:365)}(t,s)?(e.setUTCFullYear(t,i,Math.max(s,o)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!s||isNaN(+s))return a();const i=+s;let o,r=0;if(n.time&&(r=function(e){const t=e.match(Q);if(!t)return NaN;const a=ae(t[1]),n=ae(t[2]),s=ae(t[3]);if(!function(e,t,a){if(24===e)return 0===t&&0===a;return a>=0&&a<60&&t>=0&&t<60&&e>=0&&e<25}(a,n,s))return NaN;return a*T+n*S+1e3*s}(n.time),isNaN(r)))return a();if(!n.timezone){const e=new Date(i+r),t=N(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return o=function(e){if("Z"===e)return 0;const t=e.match(ee);if(!t)return 0;const a="+"===t[1]?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,s))return NaN;return a*(n*T+s*S)}(n.timezone),isNaN(o)?a():N(i+r+o)}const B={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},K=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Q=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ee=/^([+-])(\d{2})(?::?(\d{2}))?$/;function te(e){return e?parseInt(e):1}function ae(e){return e&&parseFloat(e.replace(",","."))||0}const ne=[31,null,31,30,31,30,31,31,30,31,30,31];function se(e){return e%400==0||e%4==0&&e%100!=0}const ie={PDF:"application/pdf",DOCX:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",XLSX:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",CSV:"text/csv",PNG:"image/png",JPEG:"image/jpeg",GOOGLE_DOC:"application/vnd.google-apps.document",GOOGLE_SHEET:"application/vnd.google-apps.spreadsheet",GOOGLE_SLIDES:"application/vnd.google-apps.presentation",EXTERNAL_LINK:"text/uri-list",FILE:"file"},oe="/assets",re=async t=>{try{let a,n=oe;if(t.project_id)n=`/api/projects/${t.project_id}/assets`;else{if(!t.account_id)throw console.error("Asset must be associated with a project or an account."),new Error("Asset must be associated with a project or an account.");n=`/api/accounts/${t.account_id}/assets`}if(t.file&&t.asset_type!==ie.GOOGLE_DOC&&t.asset_type!==ie.GOOGLE_SHEET&&t.asset_type!==ie.GOOGLE_SLIDES&&t.asset_type!==ie.EXTERNAL_LINK){const s=new FormData;s.append("file",t.file),s.append("name",t.name),s.append("asset_type",t.asset_type),s.append("is_public",String(t.is_public)),t.project_id&&s.append("project_id",String(t.project_id)),t.account_id&&s.append("account_id",String(t.account_id)),t.expires_at&&s.append("expires_at",t.expires_at),a=await e.post(n,s,{headers:{"Content-Type":"multipart/form-data"}})}else{const s={...t};delete s.file,a=await e.post(n,s)}return a.data}catch(a){throw console.error("Error creating asset:",a),a}},le={class:"asset-item flex items-center justify-between py-1 px-2 bg-slate-50 hover:bg-slate-100 border border-slate-200 rounded-md text-xs"},ue={class:"flex items-center overflow-hidden mr-2"},de=["title"],ce=["title"],me={key:0,class:"italic text-gray-500"},fe={key:1},pe={class:"flex items-center space-x-2 flex-shrink-0"},he=["title"],ge=c(t({__name:"AssetDisplayItem",props:{asset:{},projectId:{},accountId:{},isReadOnly:{type:Boolean}},emits:["delete-asset","asset-updated"],setup(t,{emit:c}){const m=t,f=c,p=a(!1),h=e=>{const t=(e||"").toLowerCase();let a="fas fa-file",n="text-gray-500";return t&&(t.startsWith("image/")?(a="fas fa-file-image",n="text-purple-600"):t.includes("pdf")?(a="fas fa-file-pdf",n="text-red-600"):t.includes("application/vnd.google-apps.document")||t.includes("wordprocessingml.document")||t.includes("msword")?(a="fas fa-file-word",n="text-blue-600"):t.includes("application/vnd.google-apps.spreadsheet")||t.includes("spreadsheetml.sheet")||t.includes("ms-excel")?(a="fas fa-file-excel",n="text-green-600"):t.includes("application/vnd.google-apps.presentation")||t.includes("presentationml.presentation")||t.includes("ms-powerpoint")?(a="fas fa-file-powerpoint",n="text-orange-500"):t.includes("application/zip")||t.includes("application/x-rar-compressed")||t.includes("application/x-tar")||t.includes("application/x-7z-compressed")?(a="fas fa-file-archive",n="text-yellow-600"):t.startsWith("text/csv")?(a="fas fa-file-csv",n="text-lime-600"):t.startsWith("text/")?(a="fas fa-file-alt",n="text-slate-600"):t.startsWith("video/")?(a="fas fa-file-video",n="text-pink-600"):t.startsWith("audio/")?(a="fas fa-file-audio",n="text-sky-600"):(t.includes("application/octet-stream")||"file"===t)&&(a="fas fa-file-download",n="text-indigo-600")),`${a} ${n}`},g=n(()=>(m.asset.url||"").includes("storage.googleapis.com")||!!m.asset.expires_at),v=async()=>{if(m.asset){p.value=!0;try{if(m.asset.gcs_object_path){const e=`/api/assets/${m.asset.ID}/download`,t=localStorage.getItem("snowpack_token"),a=await fetch(e,{headers:{"x-access-token":t||""}});if(!a.ok)throw new Error(`Download failed: ${a.statusText}`);const n=await a.blob(),s=window.URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=m.asset.name||`asset_${m.asset.ID}`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(s),document.body.removeChild(i)}else m.asset.url?window.open(m.asset.url,"_blank"):console.error("Asset URL is missing for asset:",m.asset.name)}catch(e){console.error("Error opening asset:",e)}finally{p.value=!1}}else console.error("Asset is undefined")},y=async()=>{if(!m.isReadOnly&&window.confirm("Are you sure you want to delete this file?"))try{m.projectId&&m.asset.ID?(await(async(t,a)=>{await e.delete(`projects/${t}/assets/${a}`)})(m.projectId,m.asset.ID),f("delete-asset",m.asset.ID)):m.accountId&&m.asset.ID?(await(async t=>{try{const a=`${oe}/${t}`;await e.delete(a)}catch(a){throw console.error(`Error deleting asset with ID ${t}:`,a),a}})(m.asset.ID),f("delete-asset",m.asset.ID)):(console.warn("Cannot delete asset: Context (Project ID or Account ID) or Asset ID is missing for asset:",m.asset.name),alert("Cannot delete asset: Context or Asset ID not provided."))}catch(t){console.error("Failed to delete asset:",t),alert(`Failed to delete asset: ${t instanceof Error?t.message:"Unknown error"}`)}},b=n(()=>{if(!m.asset.expires_at)return null;try{const e=Z(m.asset.expires_at);return isNaN(e.getTime())?"Invalid date":V(e,{addSuffix:!0})}catch(e){return console.error("Error parsing expiry date for asset:",m.asset.name,m.asset.expires_at,e),"Date error"}});return(e,t)=>(d(),s("div",le,[i("div",ue,[i("i",{class:o([h(e.asset.asset_type||e.asset.content_type),"fa-lg mr-2 flex-shrink-0"]),title:e.asset.asset_type||e.asset.content_type||"File"},null,10,de),i("a",{href:"#",onClick:r(v,["prevent"]),class:"font-medium text-blue-600 hover:text-blue-800 hover:underline truncate",title:e.asset.name},[p.value?(d(),s("span",me,"Loading...")):(d(),s("span",fe,l(e.asset.name),1))],8,ce)]),i("div",pe,[!m.isReadOnly&&g.value&&b.value&&"Invalid date"!==b.value&&"Date error"!==b.value?(d(),s("span",{key:0,class:"text-slate-500 text-[10px] italic whitespace-nowrap",title:`URL Expires: ${m.asset.expires_at?new Date(m.asset.expires_at).toLocaleString():"N/A"}`}," Expires "+l(b.value),9,he)):u("",!0),m.isReadOnly||!m.projectId&&!m.accountId?u("",!0):(d(),s("button",{key:1,onClick:y,class:"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors duration-150 ease-in-out",title:"Delete Asset"},t[0]||(t[0]=[i("i",{class:"fas fa-trash-alt"},null,-1)])))])]))}}),[["__scopeId","data-v-4b88fd74"]]),ve={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},ye={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},be={class:"mt-3 text-center sm:mt-5"},we={class:"mt-2"},xe={class:"text-sm text-gray-500"},_e={class:"mt-5 sm:mt-6 space-y-4"},De=["value"],ke=["value"],Me=["value"],Ee=["value"],Se={key:0},Te=["required"],je={key:1},Ie=["required"],Ce={key:0,class:"mt-1 text-xs text-gray-500"},Ne={class:"relative flex items-start"},Oe={class:"flex h-6 items-center"},Le={class:"mt-5 sm:mt-6 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3"},Ae=["disabled"],We=t({__name:"AssetUploaderModal",props:{isOpen:{type:Boolean},assetToEdit:{},projectId:{},accountId:{}},emits:["close","save"],setup(e,{emit:t}){const n=e,o=t,c=a({ID:0,project_id:null,account_id:null,asset_type:"file",name:"",url:"",is_public:!1,bucket_name:null,content_type:null,size:null,checksum:null,upload_status:"pending",uploaded_by:null,uploaded_at:null,expires_at:null,version:1,gcs_object_path:null,file:null}),S=a("file"),T=a(!1),j=e=>e===ie.GOOGLE_DOC||e===ie.GOOGLE_SHEET||e===ie.GOOGLE_SLIDES||e===ie.EXTERNAL_LINK;m(()=>n.isOpen,e=>{e?n.assetToEdit?(c.value={...n.assetToEdit,file:null},j(n.assetToEdit.asset_type)?S.value=n.assetToEdit.asset_type:n.assetToEdit.asset_type&&(S.value="file")):(c.value={ID:0,project_id:null,account_id:null,asset_type:"file",name:"",url:"",is_public:!1,bucket_name:null,content_type:null,size:null,checksum:null,upload_status:"pending",uploaded_by:null,uploaded_at:null,expires_at:null,version:1,gcs_object_path:null,file:null},S.value="file",n.projectId&&(c.value.project_id=n.projectId),n.accountId&&(c.value.account_id=n.accountId)):c.value.file&&(c.value.file=null)});const I=e=>{const t=e.target;t.files&&t.files[0]&&(c.value.file=t.files[0],c.value.name||(c.value.name=t.files[0].name))},C=async()=>{var e;T.value=!0;try{const t={...c.value};if("file"===S.value){if(!t.file&&!n.assetToEdit)return alert("Please select a file to upload."),void(T.value=!1);t.asset_type=(null==(e=t.file)?void 0:e.type)||ie.FILE,t.url=""}else if(t.asset_type=S.value,t.file=null,!t.url)return alert("Please enter a URL for the link."),void(T.value=!1);t.project_id&&t.account_id&&(n.projectId?t.account_id=null:n.accountId&&(t.project_id=null)),o("save",t)}catch(t){console.error("Error saving asset:",t),alert("Failed to save asset. Check console for details.")}finally{T.value=!1}},N=()=>{o("close"),c.value={ID:0,project_id:null,account_id:null,asset_type:"file",name:"",url:"",is_public:!1,bucket_name:null,content_type:null,size:null,checksum:null,upload_status:"pending",uploaded_by:null,uploaded_at:null,expires_at:null,version:1,gcs_object_path:null,file:null},S.value="file",T.value=!1};return(e,t)=>(d(),f(h(_),{as:"template",show:e.isOpen},{default:p(()=>[g(h(E),{class:"relative z-10",onClose:N},{default:p(()=>[g(h(D),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:p(()=>t[4]||(t[4]=[i("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])),_:1}),i("div",ve,[i("div",ye,[g(h(D),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:p(()=>[g(h(k),{class:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},{default:p(()=>[i("form",{onSubmit:r(C,["prevent"])},[i("div",null,[t[5]||(t[5]=i("div",{class:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-sage-100"},[i("i",{class:"fas fa-cloud-upload-alt text-2xl text-sage"})],-1)),i("div",be,[g(h(M),{as:"h3",class:"text-base font-semibold leading-6 text-gray-900"},{default:p(()=>[v(l(e.assetToEdit?"Edit Asset":"Add New Asset"),1)]),_:1}),i("div",we,[i("p",xe,l(e.assetToEdit?"Update the asset details below.":"Upload a file or link an external resource."),1)])])]),i("div",_e,[i("div",null,[t[6]||(t[6]=i("label",{for:"asset-name",class:"block text-sm font-medium text-gray-700"},"Asset Name",-1)),y(i("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>c.value.name=e),id:"asset-name",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-sage-dark focus:ring-sage-dark sm:text-sm",placeholder:"e.g., Project Proposal Q3"},null,512),[[b,c.value.name]])]),i("div",null,[t[8]||(t[8]=i("label",{for:"asset-type",class:"block text-sm font-medium text-gray-700"},"Asset Type",-1)),y(i("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>S.value=e),id:"asset-type",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-sage-dark focus:ring-sage-dark sm:text-sm"},[t[7]||(t[7]=i("option",{value:"file"},"File Upload",-1)),i("option",{value:h(ie).GOOGLE_DOC},"Google Doc Link",8,De),i("option",{value:h(ie).GOOGLE_SHEET},"Google Sheet Link",8,ke),i("option",{value:h(ie).GOOGLE_SLIDES},"Google Slides Link",8,Me),i("option",{value:h(ie).EXTERNAL_LINK},"External Link (Other)",8,Ee)],512),[[w,S.value]])]),j(S.value)?(d(),s("div",Se,[t[9]||(t[9]=i("label",{for:"asset-url",class:"block text-sm font-medium text-gray-700"},"URL",-1)),y(i("input",{type:"url","onUpdate:modelValue":t[2]||(t[2]=e=>c.value.url=e),id:"asset-url",required:j(S.value),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-sage-dark focus:ring-sage-dark sm:text-sm",placeholder:"https://docs.google.com/... or https://example.com/..."},null,8,Te),[[b,c.value.url]])])):u("",!0),"file"===S.value?(d(),s("div",je,[t[10]||(t[10]=i("label",{for:"asset-file",class:"block text-sm font-medium text-gray-700"},"File",-1)),i("input",{type:"file",onChange:I,id:"asset-file",required:"file"===S.value&&!e.assetToEdit,class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-sage-50 file:text-sage-700 hover:file:bg-sage-100"},null,40,Ie),c.value.file?(d(),s("p",Ce,"Selected: "+l(c.value.file.name),1)):u("",!0)])):u("",!0),i("div",Ne,[i("div",Oe,[y(i("input",{id:"is-public","onUpdate:modelValue":t[3]||(t[3]=e=>c.value.is_public=e),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-sage focus:ring-sage-dark"},null,512),[[x,c.value.is_public]])]),t[11]||(t[11]=i("div",{class:"ml-3 text-sm leading-6"},[i("label",{for:"is-public",class:"font-medium text-gray-900"},"Publicly Accessible"),i("p",{class:"text-gray-500 text-xs"},"If checked, the asset may be accessible via its URL without login.")],-1))])]),i("div",Le,[i("button",{type:"submit",disabled:T.value,class:"inline-flex w-full justify-center rounded-md bg-sage px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-sage-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-sage sm:col-start-2 disabled:opacity-50"},l(T.value?e.assetToEdit?"Updating...":"Uploading...":e.assetToEdit?"Update Asset":"Add Asset"),9,Ae),i("button",{type:"button",onClick:N,class:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:col-start-1 sm:mt-0"}," Cancel ")])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}});export{ge as A,We as _,re as c};
