import{T as e,h as t,r as a,f as n,c as s,a as l,q as o,z as r,E as c,x as i,u,H as d,J as x,I as p,F as b,G as g,y,K as m,o as v}from"./index-2uCPEpPG.js";async function f(t){const a=new URLSearchParams;(null==t?void 0:t.start_date)&&a.append("start_date",t.start_date),(null==t?void 0:t.end_date)&&a.append("end_date",t.end_date),(null==t?void 0:t.account)&&a.append("account",t.account),(null==t?void 0:t.invoice_id)&&a.append("invoice_id",t.invoice_id.toString()),(null==t?void 0:t.bill_id)&&a.append("bill_id",t.bill_id.toString()),(null==t?void 0:t.sub_account)&&a.append("sub_account",t.sub_account);return(await e.get(`/api/cronos/journals?${a.toString()}`)).data}async function h(t,a){const n=new URLSearchParams;t&&n.append("start_date",t),a&&n.append("end_date",a);return(await e.get(`/api/cronos/accounts/balances?${n.toString()}`)).data}function w(e){const t=e/100;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function E(e){return e.split("_").map(e=>e.charAt(0)+e.slice(1).toLowerCase()).join(" ")}function k(e){return e.includes("EXPENSE")||e.includes("OPERATING_EXPENSES")||e.includes("DISTRIBUTIONS")?"Expenses":e.includes("CASH")||e.includes("RECEIVABLE")||e.includes("ACCRUED_RECEIVABLES")||"EQUIPMENT"===e||e.includes("OTHER_ASSETS")?"Assets":e.includes("PAYABLE")||e.includes("ACCRUED_PAYROLL")||e.includes("CREDIT_CARD")||e.includes("OTHER_LIABILITIES")?"Liabilities":e.includes("REVENUE")||e.includes("CREDITS")||e.includes("OTHER_INCOME")?"Revenue":e.includes("EQUITY")||e.includes("OWNERSHIP")?"Equity":"Other"}const C={class:"p-4 bg-white min-h-screen"},_={class:"mb-3 pb-2 border-b-2 border-gray-900"},S={class:"flex items-center justify-between"},A={class:"text-xs text-gray-600 mt-0.5"},I={key:0,class:"grid grid-cols-4 gap-3 mb-3"},T={class:"bg-white border border-gray-300 p-3 rounded"},D={class:"bg-white border border-gray-300 p-3 rounded"},U={class:"text-2xl font-bold font-mono tabular-nums text-blue-700 mt-1"},N={class:"bg-white border border-gray-300 p-3 rounded"},O={class:"text-2xl font-bold font-mono tabular-nums text-orange-700 mt-1"},R={class:"bg-white border border-gray-300 p-3 rounded"},M={class:"bg-gray-50 border border-gray-300 p-2 mb-3"},L={class:"flex items-center gap-3 text-xs"},P={class:"flex-1"},j=["value"],V={class:"flex-1"},F={class:"flex items-end gap-2"},$=["disabled"],B={key:1,class:"text-center py-8"},Y={key:2,class:"border border-red-300 bg-red-50 p-2 text-red-800 text-sm"},z={key:3,class:"border border-gray-300 p-8 text-center"},H={key:4},X={key:0,class:"mb-4 border border-gray-900"},q={class:"grid grid-cols-4 gap-0 border-b border-gray-300"},J={class:"border-r border-gray-300 px-3 py-2"},G={class:"text-lg font-bold font-mono tabular-nums text-gray-900"},Q={class:"border-r border-gray-300 px-3 py-2"},W={class:"text-lg font-bold font-mono tabular-nums text-gray-900"},K={class:"border-r border-gray-300 px-3 py-2"},Z={class:"px-3 py-2 flex items-center justify-center"},ee={key:0,class:"text-xs font-medium text-green-700"},te={key:1,class:"text-xs font-medium text-red-700"},ae={key:0},ne={class:"bg-gray-100 px-3 py-1 border-b border-gray-300"},se={class:"text-xs font-bold text-gray-700 uppercase"},le={class:"w-full text-xs"},oe=["onClick"],re={class:"px-3 py-1 font-medium text-gray-900"},ce={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-700 w-28"},ie={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-700 w-28"},ue={class:"px-3 py-1 text-right font-medium font-mono tabular-nums text-gray-900 w-28"},de=["onClick"],xe={class:"px-3 py-1 pl-8 text-gray-700"},pe={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-600 w-28"},be={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-600 w-28"},ge={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-700 w-28"},ye={class:"px-3 py-1 pl-12 text-gray-600 text-xs"},me={class:"text-gray-500"},ve={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-600 text-xs w-28"},fe={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-600 text-xs w-28"},he={key:1,class:"grid grid-cols-3 gap-4 mb-4"},we={class:"border border-gray-900"},Ee={class:"w-full text-xs"},ke={class:"border-b border-gray-200"},Ce={class:"px-3 py-1.5 text-right font-bold font-mono tabular-nums text-gray-900"},_e={class:"border-b border-gray-200"},Se={class:"px-3 py-1.5 text-right font-bold font-mono tabular-nums text-gray-900"},Ae={class:"bg-gray-50"},Ie={class:"border border-gray-900"},Te={class:"w-full text-xs"},De={class:"border-b border-gray-100"},Ue={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-900"},Ne={class:"border-b border-gray-200"},Oe={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-900"},Re={class:"border-b border-gray-300 bg-gray-50"},Me={class:"border-b border-gray-100"},Le={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-900"},Pe={class:"bg-gray-50"},je={class:"border border-gray-900"},Ve={class:"w-full text-xs"},Fe={class:"px-3 py-1 pl-6 text-gray-700"},$e={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-900"},Be={class:"border-b border-gray-300"},Ye={class:"px-3 py-1.5 text-right font-bold font-mono tabular-nums text-gray-900"},ze={class:"px-3 py-1 pl-6 text-gray-700"},He={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-900"},Xe={class:"border-b border-gray-300"},qe={class:"px-3 py-1.5 text-right font-bold font-mono tabular-nums text-gray-900"},Je={class:"px-3 py-1 pl-6 text-gray-700"},Ge={class:"px-3 py-1 text-right font-mono tabular-nums text-gray-900"},Qe={class:"border-b border-gray-50"},We={class:"border-b border-gray-300 bg-gray-50"},Ke={class:"px-3 py-1.5 text-right font-bold font-mono tabular-nums text-gray-900"},Ze={key:0,class:"ml-2 text-xs text-red-600"},et={key:1,class:"ml-2 text-xs text-green-600"},tt={class:"border border-gray-900"},at={class:"bg-gray-900 text-white px-3 py-1 flex justify-between items-center"},nt={class:"text-xs"},st=["onClick"],lt={class:"flex items-center gap-2 flex-1"},ot={class:"font-semibold text-sm text-gray-900"},rt={class:"text-xs text-gray-600 ml-2"},ct={class:"flex items-center text-xs font-medium font-mono tabular-nums"},it={class:"w-36 text-right pr-2"},ut={class:"text-gray-700"},dt={class:"w-36 text-right pr-2"},xt={class:"text-gray-700"},pt={key:0},bt={class:"min-w-full text-xs table-fixed"},gt={class:"bg-white"},yt={class:"px-2 py-1 text-gray-900 whitespace-nowrap"},mt=["title"],vt={class:"px-2 py-1 text-gray-600"},ft={class:"px-2 py-1 text-right font-mono text-gray-900 tabular-nums"},ht={class:"px-2 py-1 text-right font-mono text-gray-900 tabular-nums"},wt={class:"px-2 py-1 text-center"},Et={key:0,href:"/admin/accounts-receivable",class:"text-blue-700 hover:underline text-xs"},kt={key:1,href:"/admin/accounts-payable",class:"text-blue-700 hover:underline text-xs"},Ct={key:2,class:"text-gray-400"},_t={class:"px-2 py-1 text-center"},St=["onClick"],At={key:1,class:"text-gray-400 text-xs",title:"Cannot adjust aggregated entries"},It={key:0,class:"px-3 py-8 text-center text-sm text-gray-500"},Tt={class:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Dt={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},Ut={class:"px-4 py-3"},Nt={class:"mb-3"},Ot={key:0,class:"mb-3 bg-red-50 border border-red-200 text-red-800 px-3 py-2 rounded text-xs"},Rt={class:"mb-3"},Mt={class:"min-w-full text-xs"},Lt={class:"divide-y divide-gray-200 bg-white"},Pt={class:"px-2 py-1.5 w-48"},jt=["onUpdate:modelValue"],Vt=["value"],Ft={class:"px-2 py-1.5 w-44"},$t=["onUpdate:modelValue","disabled"],Bt={value:""},Yt=["value"],zt=["onUpdate:modelValue","placeholder","disabled"],Ht={class:"px-2 py-1.5 w-24"},Xt=["onUpdate:modelValue"],qt={class:"px-2 py-1.5 w-24"},Jt=["onUpdate:modelValue"],Gt={class:"px-2 py-1.5"},Qt=["onUpdate:modelValue"],Wt={class:"px-2 py-1.5 text-center w-6"},Kt=["onClick"],Zt={class:"bg-gray-50 font-bold border-t-2 border-gray-300"},ea={key:0,class:"fas fa-check-circle mr-1"},ta={key:1,class:"fas fa-exclamation-circle mr-1"},aa={class:"px-4 py-2.5 border-t border-gray-200 flex justify-end gap-2"},na=["disabled"],sa=["disabled"],la={key:0,class:"fas fa-spinner fa-spin mr-1"},oa={class:"p-4 space-y-4"},ra={key:0,class:"border border-gray-300 rounded p-3 bg-gray-50"},ca={class:"grid grid-cols-2 gap-2 text-xs"},ia={class:"text-xs"},ua={class:"flex items-center gap-3 font-medium text-gray-700 cursor-pointer text-xs"},da={key:1,class:"border border-blue-200 rounded p-2 bg-blue-50 space-y-1.5 text-xs"},xa={class:"grid grid-cols-2 gap-1.5"},pa=["value"],ba=["value"],ga={class:"grid grid-cols-2 gap-1.5"},ya={class:"flex justify-end gap-2 pt-2"},ma=["disabled"],va=t({__name:"AccountingView",setup(e){const t=a([]),va=a(null),fa=a(null),ha=a(!0),wa=a(null),Ea=a(new Date((new Date).getFullYear(),0,1).toISOString().split("T")[0]),ka=a((new Date).toISOString().split("T")[0]),Ca=a(""),_a=a(""),Sa=a(new Set),Aa=a(new Set),Ia=a(!1),Ta=a([{account:"",subaccount:"",debit:0,credit:0,memo:""},{account:"",subaccount:"",debit:0,credit:0,memo:""}]),Da=a((new Date).toISOString().split("T")[0]),Ua=a(null),Na=a(!1),Oa=a([]),Ra=a([]),Ma=a(!1),La=a(!1),Pa=a(null),ja=a(""),Va=a(!1),Fa=a({account:"",sub_account:"",memo:"",debit:0,credit:0});async function $a(){ha.value=!0,wa.value=null;try{const e=new Date(Ea.value),a=new Date(ka.value).getTime()-e.getTime(),n=new Date(e.getTime()-864e5),s=new Date(n.getTime()-a).toISOString().split("T")[0],l=n.toISOString().split("T")[0],[o,r,c]=await Promise.all([f({start_date:Ea.value,end_date:ka.value,include_offline:!1}),h(Ea.value,ka.value),h(s,l)]);t.value=o||[],va.value=r,fa.value=c,0===Oa.value.length&&Qa()}catch(e){console.error("Error fetching accounting data:",e),wa.value="Failed to load accounting data. Please try again.",t.value=[],va.value=null,fa.value=null}finally{ha.value=!1}}function Ba(){const e=new Map;return t.value.filter(e=>!(Ca.value&&!e.sub_account.toLowerCase().includes(Ca.value.toLowerCase())||_a.value&&e.account!==_a.value)).forEach(t=>{e.has(t.account)||e.set(t.account,[]),e.get(t.account).push(t)}),Array.from(e.entries()).sort((e,t)=>e[0].localeCompare(t[0]))}function Ya(){const e=new Map;if(!va.value||!va.value.accounts)return e;let t=va.value.accounts;return _a.value&&(t=t.filter(e=>e.account===_a.value)),t.forEach(t=>{const a=k(t.account);e.has(a)||e.set(a,[]),e.get(a).push(t)}),e}function za(e){Sa.value.has(e)?Sa.value.delete(e):Sa.value.add(e)}function Ha(e){return Aa.value.has(e)}function Xa(e){const a=new Map;t.value.filter(t=>t.account===e).forEach(e=>{const t=e.sub_account||"No Subaccount";a.has(t)||a.set(t,{debits:0,credits:0});const n=a.get(t);n.debits+=e.debit,n.credits+=e.credit});let n=Array.from(a.entries()).map(([e,t])=>({subaccount:e,total_debits:t.debits,total_credits:t.credits,net_balance:t.debits-t.credits})).sort((e,t)=>Math.abs(t.net_balance)-Math.abs(e.net_balance));if(Ca.value){const e=Ca.value.toLowerCase();n=n.filter(t=>t.subaccount.toLowerCase().includes(e))}return n}function qa(e,a){return function(e){const t=new Map;return e.forEach(e=>{var a,n,s;const l=new Date(e.CreatedAt).toISOString().split("T")[0],o=e.account||"",r=e.sub_account||"No Subaccount",c=null==(a=e.memo)?void 0:a.includes("Payroll accrual for approved entries"),i=`${l}-${o}-${r}-${c?"payroll-accrual":e.memo}`;if(t.has(i)&&c){const a=t.get(i);a.debit+=e.debit,a.credit+=e.credit,a.isAggregated=!0;const l=null==(n=e.memo)?void 0:n.match(/bill #(\d+)/),o=l?l[1]:"",r=(null==(s=a.memo)?void 0:s.match(/(\d+) approvals/))||[null,"1"],c=parseInt(r[1])+1;a.memo=`Payroll accrual for approved entries (bill #${o}) - ${c} approvals`}else t.set(i,{...e,debit:e.debit,credit:e.credit,isAggregated:!1})}),Array.from(t.values())}(t.value.filter(t=>t.account===e&&(t.sub_account||"No Subaccount")===a))}function Ja(e){return new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}function Ga(){Ca.value="",_a.value=""}async function Qa(){if(!(Ma.value||Oa.value.length>0)){Ma.value=!0;try{const e=localStorage.getItem("snowpack_token"),t=await fetch("/api/cronos/chart-of-accounts?active_only=true",{headers:{"x-access-token":e||""}});if(t.ok){const e=await t.json();Oa.value=e.map(e=>({code:e.account_code,name:e.account_name}))}else console.error("Failed to load chart of accounts:",t.status);const a=await fetch("/api/cronos/subaccounts?active_only=true",{headers:{"x-access-token":e||""}});if(a.ok){const e=await a.json();Ra.value=e.map(e=>({code:e.code,name:e.name,account_code:e.account_code}))}else console.error("Failed to load subaccounts:",a.status)}catch(e){console.error("Error loading account options:",e)}finally{Ma.value=!1}}}function Wa(e){if(!e)return[];return Ra.value.filter(t=>t.account_code===e).map(e=>({value:e.code,label:`${e.code} (${e.name})`}))}async function Ka(){Ia.value=!0,Ta.value=[{account:"",subaccount:"",debit:0,credit:0,memo:""},{account:"",subaccount:"",debit:0,credit:0,memo:""}],Da.value=(new Date).toISOString().split("T")[0],Ua.value=null,await Qa()}function Za(){Ta.value.push({account:"",subaccount:"",debit:0,credit:0,memo:""})}function en(){return Ta.value.reduce((e,t)=>e+(t.debit||0),0)}function tn(){return Ta.value.reduce((e,t)=>e+(t.credit||0),0)}function an(){const e=en(),t=tn();return Math.abs(e-t)<.01}async function nn(){if(Ua.value=null,an())if(0!==en()){for(const e of Ta.value){if(!e.account)return void(Ua.value="All lines must have an account selected");if(0===e.debit&&0===e.credit)return void(Ua.value="Each line must have either a debit or credit amount");if(e.debit>0&&e.credit>0)return void(Ua.value="Each line cannot have both debit and credit amounts")}Na.value=!0;try{const e=localStorage.getItem("snowpack_token"),t=await fetch("/api/cronos/journals/manual",{method:"POST",headers:{"Content-Type":"application/json","x-access-token":e||""},body:JSON.stringify({date:Da.value,lines:Ta.value.map(e=>({account:e.account,sub_account:e.subaccount,debit:Math.round(100*e.debit),credit:Math.round(100*e.credit),memo:e.memo}))})});if(!t.ok){const e=await t.json().catch(()=>({error:"Unknown error"}));throw new Error(e.error||"Failed to create manual journal entry")}Ia.value=!1,await $a()}catch(e){console.error("Error creating manual journal entry:",e),Ua.value=e instanceof Error?e.message:"Failed to create manual journal entry"}finally{Na.value=!1}}else Ua.value="Entry cannot have zero amounts";else Ua.value="Entry must balance: Total debits must equal total credits"}function sn(){La.value=!1,Pa.value=null}async function ln(){if(Pa.value&&ja.value.trim())try{const e=localStorage.getItem("snowpack_token"),t={reason:ja.value.trim(),create_corrected:Va.value};Va.value&&(t.corrected={account:Fa.value.account,sub_account:Fa.value.sub_account,memo:Fa.value.memo,debit:Fa.value.debit,credit:Fa.value.credit});const a=await fetch(`/api/cronos/journals/${Pa.value.ID}/reverse`,{method:"POST",headers:{"Content-Type":"application/json","x-access-token":e||""},body:JSON.stringify(t)});if(!a.ok){const e=await a.json().catch(()=>({error:"Unknown error"}));throw new Error(e.error||"Failed to reverse journal entry")}sn(),await $a()}catch(e){console.error("Error reversing journal entry:",e),alert("Failed to reverse journal entry: "+(e instanceof Error?e.message:"Unknown error"))}}function on(){const e=new Date;Ea.value=new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0],ka.value=(new Date).toISOString().split("T")[0],$a()}function rn(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth()-1,1);Ea.value=t.toISOString().split("T")[0];const a=new Date(e.getFullYear(),e.getMonth(),0);ka.value=a.toISOString().split("T")[0],$a()}function cn(){const e=new Date,t=Math.floor(e.getMonth()/3);Ea.value=new Date(e.getFullYear(),3*t,1).toISOString().split("T")[0],ka.value=(new Date).toISOString().split("T")[0],$a()}function un(){const e=new Date;Ea.value=new Date(e.getFullYear(),0,1).toISOString().split("T")[0],ka.value=(new Date).toISOString().split("T")[0],$a()}function dn(){const e=new Date;Ea.value=new Date(e.getFullYear()-1,0,1).toISOString().split("T")[0],ka.value=new Date(e.getFullYear()-1,11,31).toISOString().split("T")[0],$a()}function xn(){if(!va.value||!va.value.accounts)return{cash:0,ar:0,ap:0,netProfit:0};let e=0,t=0,a=0;va.value.accounts.forEach(n=>{"CASH"===n.account?e=n.net_balance:"ACCOUNTS_RECEIVABLE"===n.account?t=n.net_balance:"ACCOUNTS_PAYABLE"===n.account&&(a=Math.abs(n.net_balance))});const n=bn().netIncome;return{cash:e,ar:t,ap:a,netProfit:n}}function pn(){if(!va.value||!va.value.accounts)return{assets:[],totalAssets:0,liabilities:[],totalLiabilities:0,equity:[],totalEquity:0,retainedEarnings:0,balances:!1};const e=[],t=[],a=[];let n=0,s=0,l=0;va.value.accounts.forEach(o=>{const r=o.account,c=k(r),i=o.net_balance;"Assets"===c?(e.push({account:r,balance:i}),n+=i):"Liabilities"===c?(t.push({account:r,balance:i}),s+=i):"Equity"===c&&(a.push({account:r,balance:i}),l+=i)});const o=bn().netIncome,r=Math.abs(n),c=Math.abs(s),i=Math.abs(l)+o,u=Math.abs(r-(c+i))<.01;return{assets:e,totalAssets:r,liabilities:t,totalLiabilities:c,equity:a,totalEquity:i,retainedEarnings:o,balances:u}}function bn(){if(!va.value||!va.value.accounts)return{revenue:0,expenses:0,netIncome:0};let e=0,t=0;va.value.accounts.forEach(a=>{const n=a.account;"REVENUE"!==n&&"ADJUSTMENT_REVENUE"!==n&&"OTHER_INCOME"!==n||(e+=a.net_balance),("PAYROLL_EXPENSE"===n||"ADJUSTMENT_EXPENSE"===n||"OWNER_DISTRIBUTIONS"===n||n.startsWith("OPERATING_EXPENSES_")||"EQUIPMENT_EXPENSE"===n||"OTHER_EXPENSES"===n)&&(t+=a.net_balance)});const a=Math.abs(e),n=Math.abs(t);return{revenue:a,expenses:n,netIncome:a-n}}function gn(){if(!fa.value||!fa.value.accounts)return{revenue:0,expenses:0,netIncome:0};let e=0,t=0;fa.value.accounts.forEach(a=>{const n=a.account;"REVENUE"!==n&&"ADJUSTMENT_REVENUE"!==n&&"OTHER_INCOME"!==n||(e+=a.net_balance),("PAYROLL_EXPENSE"===n||"ADJUSTMENT_EXPENSE"===n||"OWNER_DISTRIBUTIONS"===n||n.startsWith("OPERATING_EXPENSES_")||"EQUIPMENT_EXPENSE"===n||"OTHER_EXPENSES"===n)&&(t+=a.net_balance)});const a=Math.abs(e),n=Math.abs(t);return{revenue:a,expenses:n,netIncome:a-n}}function yn(e,t){if(0===t)return{value:0,direction:"flat"};const a=(e-t)/t*100;return{value:Math.abs(a),direction:a>0?"up":a<0?"down":"flat"}}function mn(){if(!va.value||!va.value.accounts)return{operatingCash:0,netCashChange:0,beginningCash:0,endingCash:0,collections:0,payments:0};let e=0,a=0,n=0;va.value.accounts.forEach(e=>{"CASH"===e.account&&(n=e.net_balance)});t.value.filter(e=>"CASH"===e.account).forEach(t=>{t.debit>0&&(e+=t.debit),t.credit>0&&(a+=t.credit)});const s=e-a;return{operatingCash:s,netCashChange:s,beginningCash:n-s,endingCash:n,collections:e,payments:a}}function vn(){if(!fa.value||!fa.value.accounts)return{operatingCash:0,netCashChange:0,beginningCash:0,endingCash:0,collections:0,payments:0};let e=0,t=0,a=0;fa.value.accounts.forEach(e=>{"CASH"===e.account&&(a=e.net_balance)}),fa.value.accounts.forEach(a=>{"REVENUE"!==a.account&&"ADJUSTMENT_REVENUE"!==a.account||(e+=Math.abs(a.net_balance)),"PAYROLL_EXPENSE"!==a.account&&"ADJUSTMENT_EXPENSE"!==a.account||(t+=Math.abs(a.net_balance))});const n=e-t;return{operatingCash:n,netCashChange:n,beginningCash:a-n,endingCash:a,collections:e,payments:t}}function fn(){const e=t.value.map(e=>[Ja(e.CreatedAt),E(e.account),e.sub_account||"",e.memo||"",e.debit>0?(e.debit/100).toFixed(2):"",e.credit>0?(e.credit/100).toFixed(2):"",e.invoice_id?`INV-${e.invoice_id}`:e.bill_id?`BILL-${e.bill_id}`:""]),a=[["Date","Account","SubAccount","Memo","Debit","Credit","Reference"].join(","),...e.map(e=>e.map(e=>`"${e}"`).join(","))].join("\n"),n=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),l=URL.createObjectURL(n);s.setAttribute("href",l),s.setAttribute("download",`general-ledger-${Ea.value}-to-${ka.value}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}function hn(){if(!va.value||!va.value.accounts)return;const e=va.value.accounts.map(e=>[E(e.account),k(e.account),(e.total_debits/100).toFixed(2),(e.total_credits/100).toFixed(2),(e.net_balance/100).toFixed(2)]),t=[["Account","Category","Total Debits","Total Credits","Net Balance"].join(","),...e.map(e=>e.map(e=>`"${e}"`).join(","))].join("\n"),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),s=URL.createObjectURL(a);n.setAttribute("href",s),n.setAttribute("download",`trial-balance-${Ea.value}-to-${ka.value}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}return n(()=>{$a()}),(e,a)=>(v(),s(b,null,[l("div",C,[l("div",_,[l("div",S,[l("div",null,[a[17]||(a[17]=l("h1",{class:"text-xl font-bold text-gray-900 uppercase tracking-wide"},"General Ledger",-1)),l("p",A,r(Ja(Ea.value))+" - "+r(Ja(ka.value)),1)]),l("div",{class:"flex gap-3 items-center"},[l("button",{onClick:Ka,class:"px-3 py-1.5 text-xs font-medium text-white bg-green-600 hover:bg-green-700 rounded flex items-center gap-1"},a[18]||(a[18]=[l("i",{class:"fas fa-plus"},null,-1),c(" Book Entry ")])),l("button",{onClick:hn,class:"px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 flex items-center gap-1"},a[19]||(a[19]=[l("i",{class:"fas fa-download"},null,-1),c(" Export Trial Balance ")])),l("button",{onClick:fn,class:"px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 flex items-center gap-1"},a[20]||(a[20]=[l("i",{class:"fas fa-download"},null,-1),c(" Export Journals ")]))])])]),va.value?(v(),s("div",I,[l("div",T,[a[21]||(a[21]=l("div",{class:"text-xs font-medium text-gray-600 uppercase"},"Cash Balance",-1)),l("div",{class:i(["text-2xl font-bold font-mono tabular-nums mt-1",xn().cash>=0?"text-green-700":"text-red-700"])},r(u(w)(xn().cash)),3)]),l("div",D,[a[22]||(a[22]=l("div",{class:"text-xs font-medium text-gray-600 uppercase"},"AR Outstanding",-1)),l("div",U,r(u(w)(xn().ar)),1)]),l("div",N,[a[23]||(a[23]=l("div",{class:"text-xs font-medium text-gray-600 uppercase"},"AP Outstanding",-1)),l("div",O,r(u(w)(xn().ap)),1)]),l("div",R,[a[24]||(a[24]=l("div",{class:"text-xs font-medium text-gray-600 uppercase"},"Net Profit",-1)),l("div",{class:i(["text-2xl font-bold font-mono tabular-nums mt-1",xn().netProfit>=0?"text-green-700":"text-red-700"])},r(u(w)(xn().netProfit)),3)])])):o("",!0),l("div",M,[l("div",{class:"flex gap-2 mb-2 pb-2 border-b border-gray-300"},[l("button",{onClick:on,class:"px-2 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-100"}," This Month "),l("button",{onClick:rn,class:"px-2 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-100"}," Last Month "),l("button",{onClick:cn,class:"px-2 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-100"}," This Quarter "),l("button",{onClick:un,class:"px-2 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-100"}," Year to Date "),l("button",{onClick:dn,class:"px-2 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-100"}," Last Year ")]),l("div",L,[l("div",null,[a[25]||(a[25]=l("label",{class:"block font-medium text-gray-700 mb-0.5"},"Start Date",-1)),d(l("input",{type:"date","onUpdate:modelValue":a[0]||(a[0]=e=>Ea.value=e),class:"block w-36 rounded border-gray-300 text-xs py-1 px-2"},null,512),[[x,Ea.value]])]),l("div",null,[a[26]||(a[26]=l("label",{class:"block font-medium text-gray-700 mb-0.5"},"End Date",-1)),d(l("input",{type:"date","onUpdate:modelValue":a[1]||(a[1]=e=>ka.value=e),class:"block w-36 rounded border-gray-300 text-xs py-1 px-2"},null,512),[[x,ka.value]])]),l("div",P,[a[28]||(a[28]=l("label",{class:"block font-medium text-gray-700 mb-0.5"},"Account",-1)),d(l("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>_a.value=e),class:"block w-full rounded border-gray-300 text-xs py-1"},[a[27]||(a[27]=l("option",{value:""},"All Accounts",-1)),(v(!0),s(b,null,g(Array.from(new Set(t.value.map(e=>e.account))).sort(),e=>(v(),s("option",{key:e,value:e},r(u(E)(e)),9,j))),128))],512),[[p,_a.value]])]),l("div",V,[a[29]||(a[29]=l("label",{class:"block font-medium text-gray-700 mb-0.5"},"Subaccount",-1)),d(l("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>Ca.value=e),type:"text",placeholder:"Search...",class:"block w-full rounded border-gray-300 text-xs py-1"},null,512),[[x,Ca.value]])]),l("div",F,[l("button",{onClick:Ga,class:"px-2 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50"}," Clear "),l("button",{onClick:$a,disabled:ha.value,class:"px-2 py-1 text-xs font-medium text-white bg-gray-800 rounded hover:bg-gray-900 disabled:bg-gray-400"}," Refresh ",8,$)])])]),ha.value?(v(),s("div",B,a[30]||(a[30]=[l("i",{class:"fas fa-spinner fa-spin text-2xl text-gray-600"},null,-1),l("p",{class:"mt-2 text-sm text-gray-600"},"Loading...",-1)]))):wa.value?(v(),s("div",Y,r(wa.value),1)):0===t.value.length?(v(),s("div",z,a[31]||(a[31]=[l("p",{class:"text-sm text-gray-600"},"No journal entries for this period.",-1)]))):(v(),s("div",H,[va.value?(v(),s("div",X,[a[37]||(a[37]=l("div",{class:"bg-gray-900 text-white px-3 py-1"},[l("h2",{class:"text-sm font-bold uppercase tracking-wide"},"Trial Balance")],-1)),l("div",q,[l("div",J,[a[32]||(a[32]=l("div",{class:"text-xs text-gray-600 uppercase"},"Total Debits",-1)),l("div",G,r(u(w)(va.value.total_debits)),1)]),l("div",Q,[a[33]||(a[33]=l("div",{class:"text-xs text-gray-600 uppercase"},"Total Credits",-1)),l("div",W,r(u(w)(va.value.total_credits)),1)]),l("div",K,[a[34]||(a[34]=l("div",{class:"text-xs text-gray-600 uppercase"},"Net",-1)),l("div",{class:i(["text-lg font-bold font-mono tabular-nums",va.value.is_balanced?"text-gray-900":"text-red-600"])},r(u(w)(va.value.net_balance)),3)]),l("div",Z,[va.value.is_balanced?(v(),s("span",ee,"✓ BALANCED")):(v(),s("span",te,"⚠ UNBALANCED"))])]),va.value.accounts&&va.value.accounts.length>0?(v(),s("div",ae,[(v(!0),s(b,null,g(Ya(),([e,t])=>(v(),s("div",{key:e,class:"border-b border-gray-200"},[l("div",ne,[l("h3",se,r(e),1)]),l("table",le,[a[36]||(a[36]=l("thead",null,[l("tr",{class:"border-b border-gray-300"},[l("th",{class:"px-3 py-1 text-left font-semibold text-gray-700 uppercase"},"Account"),l("th",{class:"px-3 py-1 text-right font-semibold text-gray-700 uppercase w-28"},"Debit"),l("th",{class:"px-3 py-1 text-right font-semibold text-gray-700 uppercase w-28"},"Credit"),l("th",{class:"px-3 py-1 text-right font-semibold text-gray-700 uppercase w-28"},"Balance")])],-1)),l("tbody",null,[(v(!0),s(b,null,g(t,e=>(v(),s(b,{key:e.account},[l("tr",{onClick:t=>function(e){Aa.value.has(e)?Aa.value.delete(e):Aa.value.add(e)}(e.account),class:"border-b border-gray-100 hover:bg-gray-50 cursor-pointer"},[l("td",re,[l("i",{class:i([Ha(e.account)?"fas fa-chevron-down":"fas fa-chevron-right","text-gray-400 mr-2 text-xs"])},null,2),c(" "+r(u(E)(e.account)),1)]),l("td",ce,r(u(w)(e.total_debits)),1),l("td",ie,r(u(w)(e.total_credits)),1),l("td",ue,r(u(w)(e.net_balance)),1)],8,oe),Ha(e.account)?(v(!0),s(b,{key:0},g(Xa(e.account),t=>(v(),s(b,{key:`${e.account}-${t.subaccount}`},[l("tr",{onClick:y(a=>za(`${e.account}:${t.subaccount}`),["stop"]),class:"bg-gray-50 border-b border-gray-100 hover:bg-gray-100 cursor-pointer"},[l("td",xe,[l("i",{class:i([Sa.value.has(`${e.account}:${t.subaccount}`)?"fas fa-chevron-down":"fas fa-chevron-right","text-gray-400 mr-2 text-xs"])},null,2),c(" "+r(t.subaccount),1)]),l("td",pe,r(u(w)(t.total_debits)),1),l("td",be,r(u(w)(t.total_credits)),1),l("td",ge,r(u(w)(t.net_balance)),1)],8,de),Sa.value.has(`${e.account}:${t.subaccount}`)?(v(!0),s(b,{key:0},g(qa(e.account,t.subaccount),e=>(v(),s("tr",{key:e.ID,class:"bg-white border-b border-gray-50"},[l("td",ye,[l("div",null,r(Ja(e.CreatedAt)),1),l("div",me,r(e.memo||"-"),1)]),l("td",ve,r(e.debit>0?u(w)(e.debit):"-"),1),l("td",fe,r(e.credit>0?u(w)(e.credit):"-"),1),a[35]||(a[35]=l("td",{class:"px-3 py-1 text-right w-28"},null,-1))]))),128)):o("",!0)],64))),128)):o("",!0)],64))),128))])])]))),128))])):o("",!0)])):o("",!0),va.value?(v(),s("div",he,[l("div",we,[a[41]||(a[41]=l("div",{class:"bg-gray-900 text-white px-3 py-1"},[l("h2",{class:"text-sm font-bold uppercase tracking-wide"},"Profit & Loss")],-1)),l("table",Ee,[l("tbody",null,[l("tr",ke,[a[38]||(a[38]=l("td",{class:"px-3 py-1.5 font-bold text-gray-900 uppercase"},"Revenue",-1)),l("td",Ce,[c(r(u(w)(bn().revenue))+" ",1),fa.value?(v(),s("span",{key:0,class:i(["ml-2 text-xs font-normal",{"text-green-600":"up"===yn(bn().revenue,gn().revenue).direction,"text-red-600":"down"===yn(bn().revenue,gn().revenue).direction,"text-gray-600":"flat"===yn(bn().revenue,gn().revenue).direction}])}," ("+r("up"===yn(bn().revenue,gn().revenue).direction?"+":"down"===yn(bn().revenue,gn().revenue).direction?"-":"")+r(yn(bn().revenue,gn().revenue).value.toFixed(1))+"%) ",3)):o("",!0)])]),l("tr",_e,[a[39]||(a[39]=l("td",{class:"px-3 py-1.5 font-bold text-gray-900 uppercase"},"Expenses",-1)),l("td",Se,[c(r(u(w)(bn().expenses))+" ",1),fa.value?(v(),s("span",{key:0,class:i(["ml-2 text-xs font-normal",{"text-red-600":"up"===yn(bn().expenses,gn().expenses).direction,"text-green-600":"down"===yn(bn().expenses,gn().expenses).direction,"text-gray-600":"flat"===yn(bn().expenses,gn().expenses).direction}])}," ("+r("up"===yn(bn().expenses,gn().expenses).direction?"+":"down"===yn(bn().expenses,gn().expenses).direction?"-":"")+r(yn(bn().expenses,gn().expenses).value.toFixed(1))+"%) ",3)):o("",!0)])]),l("tr",Ae,[a[40]||(a[40]=l("td",{class:"px-3 py-1.5 font-bold text-gray-900 uppercase"},"Net Income",-1)),l("td",{class:i(["px-3 py-1.5 text-right text-lg font-bold font-mono tabular-nums",bn().netIncome>=0?"text-green-700":"text-red-700"])},[c(r(u(w)(bn().netIncome))+" ",1),fa.value?(v(),s("span",{key:0,class:i(["ml-2 text-xs font-normal",{"text-green-600":"up"===yn(bn().netIncome,gn().netIncome).direction,"text-red-600":"down"===yn(bn().netIncome,gn().netIncome).direction,"text-gray-600":"flat"===yn(bn().netIncome,gn().netIncome).direction}])}," ("+r("up"===yn(bn().netIncome,gn().netIncome).direction?"+":"down"===yn(bn().netIncome,gn().netIncome).direction?"-":"")+r(yn(bn().netIncome,gn().netIncome).value.toFixed(1))+"%) ",3)):o("",!0)],2)])])])]),l("div",Ie,[a[47]||(a[47]=l("div",{class:"bg-gray-900 text-white px-3 py-1"},[l("h2",{class:"text-sm font-bold uppercase tracking-wide"},"Cash Flow")],-1)),l("table",Te,[l("tbody",null,[l("tr",De,[a[42]||(a[42]=l("td",{class:"px-3 py-1 text-gray-700"},"Cash Collections",-1)),l("td",Ue,[c(r(u(w)(mn().collections))+" ",1),fa.value?(v(),s("span",{key:0,class:i(["ml-2 text-xs font-normal",{"text-green-600":"up"===yn(mn().collections,vn().collections).direction,"text-red-600":"down"===yn(mn().collections,vn().collections).direction,"text-gray-600":"flat"===yn(mn().collections,vn().collections).direction}])}," ("+r("up"===yn(mn().collections,vn().collections).direction?"+":"down"===yn(mn().collections,vn().collections).direction?"-":"")+r(yn(mn().collections,vn().collections).value.toFixed(1))+"%) ",3)):o("",!0)])]),l("tr",Ne,[a[43]||(a[43]=l("td",{class:"px-3 py-1 text-gray-700"},"Cash Payments",-1)),l("td",Oe,[c(" ("+r(u(w)(mn().payments))+") ",1),fa.value?(v(),s("span",{key:0,class:i(["ml-2 text-xs font-normal",{"text-red-600":"up"===yn(mn().payments,vn().payments).direction,"text-green-600":"down"===yn(mn().payments,vn().payments).direction,"text-gray-600":"flat"===yn(mn().payments,vn().payments).direction}])}," ("+r("up"===yn(mn().payments,vn().payments).direction?"+":"down"===yn(mn().payments,vn().payments).direction?"-":"")+r(yn(mn().payments,vn().payments).value.toFixed(1))+"%) ",3)):o("",!0)])]),l("tr",Re,[a[44]||(a[44]=l("td",{class:"px-3 py-1.5 font-bold text-gray-900 uppercase"},"Operating Cash Flow",-1)),l("td",{class:i(["px-3 py-1.5 text-right font-bold font-mono tabular-nums",mn().operatingCash>=0?"text-gray-900":"text-red-700"])},[c(r(u(w)(mn().operatingCash))+" ",1),fa.value?(v(),s("span",{key:0,class:i(["ml-2 text-xs font-normal",{"text-green-600":"up"===yn(mn().operatingCash,vn().operatingCash).direction,"text-red-600":"down"===yn(mn().operatingCash,vn().operatingCash).direction,"text-gray-600":"flat"===yn(mn().operatingCash,vn().operatingCash).direction}])}," ("+r("up"===yn(mn().operatingCash,vn().operatingCash).direction?"+":"down"===yn(mn().operatingCash,vn().operatingCash).direction?"-":"")+r(yn(mn().operatingCash,vn().operatingCash).value.toFixed(1))+"%) ",3)):o("",!0)],2)]),l("tr",Me,[a[45]||(a[45]=l("td",{class:"px-3 py-1 text-gray-700"},"Beginning Cash",-1)),l("td",Le,r(u(w)(mn().beginningCash)),1)]),l("tr",Pe,[a[46]||(a[46]=l("td",{class:"px-3 py-1.5 font-bold text-gray-900 uppercase"},"Ending Cash",-1)),l("td",{class:i(["px-3 py-1.5 text-right text-lg font-bold font-mono tabular-nums",mn().endingCash>=0?"text-green-700":"text-red-700"])},[c(r(u(w)(mn().endingCash))+" ",1),fa.value?(v(),s("span",{key:0,class:i(["ml-2 text-xs font-normal",{"text-green-600":"up"===yn(mn().endingCash,vn().endingCash).direction,"text-red-600":"down"===yn(mn().endingCash,vn().endingCash).direction,"text-gray-600":"flat"===yn(mn().endingCash,vn().endingCash).direction}])}," ("+r("up"===yn(mn().endingCash,vn().endingCash).direction?"+":"down"===yn(mn().endingCash,vn().endingCash).direction?"-":"")+r(yn(mn().endingCash,vn().endingCash).value.toFixed(1))+"%) ",3)):o("",!0)],2)])])])]),l("div",je,[a[55]||(a[55]=l("div",{class:"bg-gray-900 text-white px-3 py-1"},[l("h2",{class:"text-sm font-bold uppercase tracking-wide"},"Balance Sheet")],-1)),l("table",Ve,[l("tbody",null,[a[52]||(a[52]=l("tr",{class:"bg-gray-100 border-b border-gray-300"},[l("td",{colspan:"2",class:"px-3 py-1.5 font-bold text-gray-900 uppercase"},"Assets")],-1)),(v(!0),s(b,null,g(pn().assets,e=>(v(),s("tr",{key:e.account,class:"border-b border-gray-50"},[l("td",Fe,r(u(E)(e.account)),1),l("td",$e,r(u(w)(Math.abs(e.balance))),1)]))),128)),l("tr",Be,[a[48]||(a[48]=l("td",{class:"px-3 py-1.5 pl-6 font-bold text-gray-900"},"Total Assets",-1)),l("td",Ye,r(u(w)(Math.abs(pn().totalAssets))),1)]),a[53]||(a[53]=l("tr",{class:"bg-gray-100 border-b border-gray-300"},[l("td",{colspan:"2",class:"px-3 py-1.5 font-bold text-gray-900 uppercase"},"Liabilities")],-1)),(v(!0),s(b,null,g(pn().liabilities,e=>(v(),s("tr",{key:e.account,class:"border-b border-gray-50"},[l("td",ze,r(u(E)(e.account)),1),l("td",He,r(u(w)(Math.abs(e.balance))),1)]))),128)),l("tr",Xe,[a[49]||(a[49]=l("td",{class:"px-3 py-1.5 pl-6 font-bold text-gray-900"},"Total Liabilities",-1)),l("td",qe,r(u(w)(Math.abs(pn().totalLiabilities))),1)]),a[54]||(a[54]=l("tr",{class:"bg-gray-100 border-b border-gray-300"},[l("td",{colspan:"2",class:"px-3 py-1.5 font-bold text-gray-900 uppercase"},"Equity")],-1)),(v(!0),s(b,null,g(pn().equity,e=>(v(),s("tr",{key:e.account,class:"border-b border-gray-50"},[l("td",Je,r(u(E)(e.account)),1),l("td",Ge,r(u(w)(Math.abs(e.balance))),1)]))),128)),l("tr",Qe,[a[50]||(a[50]=l("td",{class:"px-3 py-1 pl-6 text-gray-700"},"Retained Earnings",-1)),l("td",{class:i(["px-3 py-1 text-right font-mono tabular-nums",pn().retainedEarnings>=0?"text-green-700":"text-red-700"])},r(u(w)(Math.abs(pn().retainedEarnings))),3)]),l("tr",We,[a[51]||(a[51]=l("td",{class:"px-3 py-1.5 pl-6 font-bold text-gray-900"},"Total Equity",-1)),l("td",Ke,[c(r(u(w)(Math.abs(pn().totalEquity)))+" ",1),pn().balances?(v(),s("span",et,"✓")):(v(),s("span",Ze,"⚠️"))])])])])])])):o("",!0),l("div",tt,[l("div",at,[a[56]||(a[56]=l("h2",{class:"text-sm font-bold uppercase tracking-wide"},"Journal Entries",-1)),l("span",nt,r(t.value.length)+" entries",1)]),l("div",null,[(v(!0),s(b,null,g(Ba(),([e,t])=>(v(),s("div",{key:e,class:"border-b border-gray-300"},[l("div",{onClick:t=>za(e),class:"px-3 py-1.5 cursor-pointer hover:bg-gray-50 flex items-center justify-between bg-gray-100"},[l("div",lt,[l("i",{class:i([Sa.value.has(e)?"fa-caret-down":"fa-caret-right","fas text-gray-600 text-xs"])},null,2),l("div",null,[l("span",ot,r(u(E)(e)),1),l("span",rt,"("+r(t.length)+")",1)])]),l("div",ct,[l("div",it,[l("span",ut,"DR: "+r(u(w)(t.reduce((e,t)=>e+t.debit,0))),1)]),l("div",dt,[l("span",xt,"CR: "+r(u(w)(t.reduce((e,t)=>e+t.credit,0))),1)])])],8,st),Sa.value.has(e)?(v(),s("div",pt,[l("table",bt,[a[58]||(a[58]=l("colgroup",null,[l("col",{class:"w-24"}),l("col",{class:"w-44"}),l("col"),l("col",{class:"w-36"}),l("col",{class:"w-36"}),l("col",{class:"w-24"})],-1)),a[59]||(a[59]=l("thead",{class:"bg-gray-50 border-b border-gray-300"},[l("tr",null,[l("th",{class:"px-2 py-1 text-left font-semibold text-gray-700 uppercase"},"Date"),l("th",{class:"px-2 py-1 text-left font-semibold text-gray-700 uppercase"},"Subaccount"),l("th",{class:"px-2 py-1 text-left font-semibold text-gray-700 uppercase"},"Memo"),l("th",{class:"px-2 py-1 text-right font-semibold text-gray-700 uppercase"},"Debit"),l("th",{class:"px-2 py-1 text-right font-semibold text-gray-700 uppercase"},"Credit"),l("th",{class:"px-2 py-1 text-center font-semibold text-gray-700 uppercase"},"Ref"),l("th",{class:"px-2 py-1 text-center font-semibold text-gray-700 uppercase"},"Actions")])],-1)),l("tbody",gt,[(v(!0),s(b,null,g(t,e=>(v(),s("tr",{key:e.ID,class:"border-b border-gray-100 hover:bg-gray-50"},[l("td",yt,r(Ja(e.CreatedAt)),1),l("td",{class:"px-2 py-1 text-gray-700 truncate",title:e.sub_account},r(e.sub_account||"-"),9,mt),l("td",vt,r(e.memo),1),l("td",ft,r(e.debit>0?u(w)(e.debit):""),1),l("td",ht,r(e.credit>0?u(w)(e.credit):""),1),l("td",wt,[e.invoice_id?(v(),s("a",Et," INV-"+r(e.invoice_id),1)):e.bill_id?(v(),s("a",kt," BILL-"+r(e.bill_id),1)):(v(),s("span",Ct,"-"))]),l("td",_t,[e.isAggregated?(v(),s("span",At,"-")):(v(),s("button",{key:0,onClick:t=>function(e){Pa.value=e,ja.value="",Va.value=!1,Fa.value={account:e.account,sub_account:e.sub_account||"",memo:e.memo||"",debit:e.debit/100,credit:e.credit/100},La.value=!0,Qa()}(e),class:"text-orange-600 hover:text-orange-900",title:"Adjust/Reverse Entry"},a[57]||(a[57]=[l("i",{class:"fas fa-exclamation-triangle text-xs"},null,-1)]),8,St))])]))),128))])])])):o("",!0)]))),128))]),0===Ba().length?(v(),s("div",It," No entries match the selected filters. ")):o("",!0)])]))]),Ia.value?(v(),s("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:a[7]||(a[7]=y(e=>Ia.value=!1,["self"]))},[l("div",Tt,[l("div",Dt,[a[61]||(a[61]=l("h2",{class:"text-lg font-bold text-gray-900"},"Book Manual Journal Entry",-1)),l("button",{onClick:a[4]||(a[4]=e=>Ia.value=!1),class:"text-gray-400 hover:text-gray-600"},a[60]||(a[60]=[l("i",{class:"fas fa-times text-xl"},null,-1)]))]),l("div",Ut,[l("div",Nt,[a[62]||(a[62]=l("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Entry Date",-1)),d(l("input",{type:"date","onUpdate:modelValue":a[5]||(a[5]=e=>Da.value=e),class:"block w-40 rounded border-gray-300 text-xs py-1 px-2"},null,512),[[x,Da.value]])]),Ua.value?(v(),s("div",Ot,[a[63]||(a[63]=l("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),c(r(Ua.value),1)])):o("",!0),l("div",Rt,[l("table",Mt,[a[67]||(a[67]=l("thead",{class:"bg-gray-50"},[l("tr",null,[l("th",{class:"px-2 py-1.5 text-left text-xs font-medium text-gray-700 uppercase tracking-wide"},"Account"),l("th",{class:"px-2 py-1.5 text-left text-xs font-medium text-gray-700 uppercase tracking-wide"},"Subaccount"),l("th",{class:"px-2 py-1.5 text-right text-xs font-medium text-gray-700 uppercase tracking-wide"},"Debit ($)"),l("th",{class:"px-2 py-1.5 text-right text-xs font-medium text-gray-700 uppercase tracking-wide"},"Credit ($)"),l("th",{class:"px-2 py-1.5 text-left text-xs font-medium text-gray-700 uppercase tracking-wide"},"Memo"),l("th",{class:"px-2 py-1.5 text-center text-xs font-medium text-gray-700 uppercase tracking-wide w-8"})])],-1)),l("tbody",Lt,[(v(!0),s(b,null,g(Ta.value,(e,t)=>(v(),s("tr",{key:t},[l("td",Pt,[d(l("select",{"onUpdate:modelValue":t=>e.account=t,class:"block w-full rounded border-gray-300 text-[11px] py-0.5 px-1",style:{"font-size":"11px"},required:""},[a[64]||(a[64]=l("option",{value:""},"Select Account...",-1)),(v(!0),s(b,null,g(Oa.value,e=>(v(),s("option",{key:e.code,value:e.code},r(e.code)+" - "+r(e.name),9,Vt))),128))],8,jt),[[p,e.account]])]),l("td",Ft,[Wa(e.account).length>0?d((v(),s("select",{key:0,"onUpdate:modelValue":t=>e.subaccount=t,class:"block w-full rounded border-gray-300 text-[11px] py-0.5 px-1",style:{"font-size":"11px"},disabled:Ma.value},[l("option",Bt,r(Ma.value?"Loading...":"Select..."),1),(v(!0),s(b,null,g(Wa(e.account),e=>(v(),s("option",{key:e.value,value:e.value},r(e.label),9,Yt))),128))],8,$t)),[[p,e.subaccount]]):d((v(),s("input",{key:1,type:"text","onUpdate:modelValue":t=>e.subaccount=t,placeholder:Ma.value?"Loading...":"Optional",class:"block w-full rounded border-gray-300 text-[11px] py-0.5 px-1.5",style:{"font-size":"11px"},disabled:Ma.value},null,8,zt)),[[x,e.subaccount]])]),l("td",Ht,[d(l("input",{type:"number","onUpdate:modelValue":t=>e.debit=t,step:"0.01",min:"0",class:"block w-full rounded border-gray-300 text-[11px] py-0.5 px-1.5 text-right font-mono",style:{"font-size":"11px"}},null,8,Xt),[[x,e.debit,void 0,{number:!0}]])]),l("td",qt,[d(l("input",{type:"number","onUpdate:modelValue":t=>e.credit=t,step:"0.01",min:"0",class:"block w-full rounded border-gray-300 text-[11px] py-0.5 px-1.5 text-right font-mono",style:{"font-size":"11px"}},null,8,Jt),[[x,e.credit,void 0,{number:!0}]])]),l("td",Gt,[d(l("input",{type:"text","onUpdate:modelValue":t=>e.memo=t,placeholder:"Description...",class:"block w-full rounded border-gray-300 text-[11px] py-0.5 px-1.5",style:{"font-size":"11px"}},null,8,Qt),[[x,e.memo]])]),l("td",Wt,[Ta.value.length>2?(v(),s("button",{key:0,onClick:e=>function(e){Ta.value.length>2&&Ta.value.splice(e,1)}(t),class:"text-red-600 hover:text-red-800 text-xs"},a[65]||(a[65]=[l("i",{class:"fas fa-times"},null,-1)]),8,Kt)):o("",!0)])]))),128))]),l("tfoot",Zt,[l("tr",null,[a[66]||(a[66]=l("td",{colspan:"2",class:"px-2 py-1.5 text-right text-xs"},"Totals:",-1)),l("td",{class:i(["px-2 py-1.5 text-right font-mono text-xs",an()?"text-green-700":"text-red-700"])}," $"+r(en().toFixed(2)),3),l("td",{class:i(["px-2 py-1.5 text-right font-mono text-xs",an()?"text-green-700":"text-red-700"])}," $"+r(tn().toFixed(2)),3),l("td",{colspan:"2",class:i(["px-2 py-1.5 text-xs",an()?"text-green-700":"text-red-700"])},[an()&&en()>0?(v(),s("i",ea)):o("",!0),!an()&&en()>0?(v(),s("i",ta)):o("",!0),c(" "+r(an()?"Balanced":"Unbalanced"),1)],2)])])])]),l("button",{onClick:Za,class:"px-2 py-1 text-xs font-medium text-blue-600 border border-blue-600 rounded hover:bg-blue-50"},a[68]||(a[68]=[l("i",{class:"fas fa-plus mr-1"},null,-1),c(" Add Line ")]))]),l("div",aa,[l("button",{onClick:a[6]||(a[6]=e=>Ia.value=!1),class:"px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50",disabled:Na.value}," Cancel ",8,na),l("button",{onClick:nn,class:"px-3 py-1.5 text-xs font-medium text-white bg-green-600 hover:bg-green-700 rounded disabled:bg-gray-400",disabled:Na.value||!an()||0===en()},[Na.value?(v(),s("i",la)):o("",!0),c(" "+r(Na.value?"Booking...":"Book Entry"),1)],8,sa)])])])):o("",!0),La.value?(v(),s("div",{key:1,onClick:sn,class:"fixed inset-0 z-50 flex items-center justify-center bg-gray-500/75"},[l("div",{onClick:a[16]||(a[16]=y(()=>{},["stop"])),class:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},[a[88]||(a[88]=l("div",{class:"bg-orange-600 px-4 py-3 rounded-t-lg"},[l("h3",{class:"text-sm font-semibold text-white"},"Adjust/Reverse Journal Entry")],-1)),l("div",oa,[a[87]||(a[87]=l("div",{class:"flex items-start gap-3 bg-yellow-50 border border-yellow-200 rounded p-3"},[l("i",{class:"fas fa-exclamation-triangle text-yellow-600 text-xl"}),l("div",{class:"text-xs text-gray-700"},[l("p",{class:"font-medium mb-1"},"This will create reversing journal entries"),l("p",null,"The original entry will remain in the ledger for audit purposes. A new reversing entry will be created to cancel it out, and optionally a corrected entry can be created with the right values.")])],-1)),Pa.value?(v(),s("div",ra,[a[75]||(a[75]=l("h4",{class:"text-xs font-semibold text-gray-900 mb-2"},"Original Entry",-1)),l("div",ca,[l("div",null,[a[69]||(a[69]=l("span",{class:"font-medium"},"Date:",-1)),c(" "+r(Ja(Pa.value.CreatedAt)),1)]),l("div",null,[a[70]||(a[70]=l("span",{class:"font-medium"},"Account:",-1)),c(" "+r(u(E)(Pa.value.account)),1)]),l("div",null,[a[71]||(a[71]=l("span",{class:"font-medium"},"Subaccount:",-1)),c(" "+r(Pa.value.sub_account||"-"),1)]),l("div",null,[a[72]||(a[72]=l("span",{class:"font-medium"},"Memo:",-1)),c(" "+r(Pa.value.memo),1)]),l("div",null,[a[73]||(a[73]=l("span",{class:"font-medium"},"Debit:",-1)),c(" "+r(u(w)(Pa.value.debit)),1)]),l("div",null,[a[74]||(a[74]=l("span",{class:"font-medium"},"Credit:",-1)),c(" "+r(u(w)(Pa.value.credit)),1)])])])):o("",!0),l("div",null,[a[76]||(a[76]=l("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Reason for Reversal *",-1)),d(l("textarea",{"onUpdate:modelValue":a[8]||(a[8]=e=>ja.value=e),rows:"3",class:"w-full px-2 py-1.5 text-xs border rounded focus:ring-1 focus:ring-orange-500",placeholder:"Explain why this entry needs to be reversed..."},null,512),[[x,ja.value]])]),l("div",ia,[l("label",ua,[d(l("input",{type:"checkbox","onUpdate:modelValue":a[9]||(a[9]=e=>Va.value=e),class:"rounded border-gray-300 text-sage focus:ring-sage h-4 w-4"},null,512),[[m,Va.value]]),a[77]||(a[77]=l("span",{class:"text-xs"},"Create corrected entry",-1))])]),Va.value?(v(),s("div",da,[a[85]||(a[85]=l("h4",{class:"font-semibold text-gray-900 text-xs mb-1"},"Corrected Entry Details",-1)),l("div",xa,[l("div",null,[a[79]||(a[79]=l("label",{class:"block font-medium text-gray-700 mb-0.5 text-xs"},"Account",-1)),d(l("select",{"onUpdate:modelValue":a[10]||(a[10]=e=>Fa.value.account=e),class:"w-full px-1.5 py-0.5 border rounded text-xs",style:{"font-size":"11px"}},[a[78]||(a[78]=l("option",{value:""},"Select account...",-1)),(v(!0),s(b,null,g(Oa.value,e=>(v(),s("option",{key:e.code,value:e.code},r(e.code)+" - "+r(e.name),9,pa))),128))],512),[[p,Fa.value.account]])]),l("div",null,[a[81]||(a[81]=l("label",{class:"block font-medium text-gray-700 mb-0.5 text-xs"},"Subaccount",-1)),Wa(Fa.value.account).length>0?d((v(),s("select",{key:0,"onUpdate:modelValue":a[11]||(a[11]=e=>Fa.value.sub_account=e),class:"w-full px-1.5 py-0.5 border rounded text-xs",style:{"font-size":"11px"}},[a[80]||(a[80]=l("option",{value:""},"None",-1)),(v(!0),s(b,null,g(Wa(Fa.value.account),e=>(v(),s("option",{key:e.value,value:e.value},r(e.label),9,ba))),128))],512)),[[p,Fa.value.sub_account]]):d((v(),s("input",{key:1,type:"text","onUpdate:modelValue":a[12]||(a[12]=e=>Fa.value.sub_account=e),class:"w-full px-1.5 py-0.5 border rounded text-xs",style:{"font-size":"11px"},placeholder:"Optional"},null,512)),[[x,Fa.value.sub_account]])])]),l("div",null,[a[82]||(a[82]=l("label",{class:"block font-medium text-gray-700 mb-0.5 text-xs"},"Memo",-1)),d(l("input",{type:"text","onUpdate:modelValue":a[13]||(a[13]=e=>Fa.value.memo=e),class:"w-full px-1.5 py-0.5 border rounded text-xs",style:{"font-size":"11px"},placeholder:"Description of corrected entry..."},null,512),[[x,Fa.value.memo]])]),l("div",ga,[l("div",null,[a[83]||(a[83]=l("label",{class:"block font-medium text-gray-700 mb-0.5 text-xs"},"Debit ($)",-1)),d(l("input",{type:"number","onUpdate:modelValue":a[14]||(a[14]=e=>Fa.value.debit=e),step:"0.01",class:"w-full px-1.5 py-0.5 border rounded text-right font-mono text-xs",style:{"font-size":"11px"}},null,512),[[x,Fa.value.debit,void 0,{number:!0}]])]),l("div",null,[a[84]||(a[84]=l("label",{class:"block font-medium text-gray-700 mb-0.5 text-xs"},"Credit ($)",-1)),d(l("input",{type:"number","onUpdate:modelValue":a[15]||(a[15]=e=>Fa.value.credit=e),step:"0.01",class:"w-full px-1.5 py-0.5 border rounded text-right font-mono text-xs",style:{"font-size":"11px"}},null,512),[[x,Fa.value.credit,void 0,{number:!0}]])])])])):o("",!0),l("div",ya,[l("button",{onClick:sn,class:"px-3 py-1.5 text-xs text-gray-700 border border-gray-300 rounded hover:bg-gray-50"}," Cancel "),l("button",{onClick:ln,disabled:!ja.value.trim(),class:"px-3 py-1.5 text-xs bg-orange-600 text-white rounded hover:bg-orange-700 disabled:bg-gray-400"},[a[86]||(a[86]=l("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1)),c(" "+r(Va.value?"Reverse & Correct":"Reverse Only"),1)],8,ma)])])])])):o("",!0)],64))}});export{va as default};
