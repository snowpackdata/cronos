import{h as e,r as t,b as a,f as s,c as l,a as i,q as n,F as r,G as o,z as d,x as c,v as u,H as x,E as g,J as v,K as p,o as b}from"./index-2uCPEpPG.js";import{g as y,a as m,u as f,c as h,d as w,b as k,e as C,f as j}from"./expenseTags-CKM3oGuD.js";import"./index-8V-xrl-L.js";const D={class:"min-h-screen bg-gray-50 p-4"},N={class:"max-w-7xl mx-auto"},T={class:"grid grid-cols-2 gap-4"},I={class:"bg-white shadow-sm rounded border border-gray-200"},_={class:"min-w-full divide-y divide-gray-200"},U={class:"bg-white divide-y divide-gray-200"},F={key:0},S={class:"px-2 py-1 text-xs text-gray-900"},V={class:"font-medium"},E={key:0,class:"text-gray-500 text-xs"},M={class:"px-2 py-1 text-center"},A={class:"px-2 py-1 text-center"},q={class:"flex justify-center gap-1"},B=["onClick"],$=["onClick"],z={class:"bg-white shadow-sm rounded border border-gray-200"},L={class:"min-w-full divide-y divide-gray-200"},O={class:"bg-white divide-y divide-gray-200"},G={key:0},H={class:"px-2 py-1 text-xs text-gray-900"},J={class:"font-medium"},K={key:0,class:"text-gray-500 text-xs"},Q={key:1,class:"mt-0.5"},P={class:"w-full bg-gray-200 rounded-full h-1"},R={class:"flex justify-between text-xs mt-0.5"},W={class:"text-gray-500"},X={class:"px-2 py-1 text-right text-xs text-gray-900"},Y={class:"px-2 py-1 text-center"},Z={class:"px-2 py-1 text-center"},ee={class:"flex justify-center gap-1"},te=["onClick"],ae=["onClick"],se={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},le={class:"flex items-center justify-center min-h-screen px-4"},ie={class:"relative bg-white rounded shadow-xl max-w-lg w-full"},ne={class:"bg-sage text-white px-4 py-2 flex justify-between items-center"},re={class:"text-xs font-semibold"},oe={class:"p-4"},de={class:"space-y-2"},ce={key:0},ue={class:"flex items-center"},xe={key:1,class:"text-xs text-red-600 bg-red-50 p-2 rounded"},ge={class:"mt-3 flex justify-end gap-2"},ve=["disabled"],pe={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},be={class:"flex items-center justify-center min-h-screen px-4"},ye={class:"relative bg-white rounded shadow-xl max-w-lg w-full"},me={class:"bg-sage text-white px-4 py-2 flex justify-between items-center"},fe={class:"text-xs font-semibold"},he={class:"p-4"},we={class:"space-y-2"},ke={class:"flex rounded border border-gray-300 bg-white focus-within:ring-sage focus-within:border-sage overflow-hidden"},Ce={class:"flex items-center"},je={key:0,class:"text-xs text-red-600 bg-red-50 p-2 rounded"},De={class:"mt-3 flex justify-end gap-2"},Ne=["disabled"],Te=e({__name:"ExpenseConfigView",setup(e){const Te=t([]),Ie=t(!1),_e=t(!1),Ue=t(!1),Fe=t(""),Se=t(null),Ve=t({name:"",description:"",active:!0}),Ee=t([]),Me=t(!1),Ae=t(!1),qe=t(!1),Be=t(""),$e=t(null),ze=t({name:"",description:"",active:!0,budget:null}),Le=a({get:()=>ze.value.budget?ze.value.budget/100:null,set:e=>ze.value.budget=e?Math.round(100*e):null});async function Oe(){try{Te.value=await y(!1)}catch(e){console.error("Failed to fetch expense categories:",e)}}async function Ge(){try{Ee.value=await m(!1)}catch(e){console.error("Failed to fetch expense tags:",e)}}function He(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e/100)}function Je(e){return e.remaining_budget?e.remaining_budget<0?"text-red-600 font-semibold":e.budget_percentage&&e.budget_percentage>90?"text-orange-600":"text-green-600":"text-gray-900"}function Ke(){_e.value=!1,Se.value=null,Ve.value={name:"",description:"",active:!0},Fe.value="",Ie.value=!0}function Qe(){Ie.value=!1,Fe.value=""}async function Pe(){var e,t;if(Ve.value.name.trim()){Ue.value=!0,Fe.value="";try{_e.value&&Se.value?await f(Se.value.ID,Ve.value):await h({name:Ve.value.name,description:Ve.value.description}),await Oe(),Qe()}catch(a){Fe.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.error)||"Failed to save category"}finally{Ue.value=!1}}else Fe.value="Category name is required"}function Re(){Ae.value=!1,$e.value=null,ze.value={name:"",description:"",active:!0,budget:null},Be.value="",Me.value=!0}function We(){Me.value=!1,Be.value=""}async function Xe(){var e,t;if(ze.value.name.trim()){qe.value=!0,Be.value="";try{Ae.value&&$e.value?await k($e.value.ID,ze.value):await C(ze.value),await Ge(),We()}catch(a){Be.value=(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.error)||"Failed to save tag"}finally{qe.value=!1}}else Be.value="Tag name is required"}return s(()=>{Oe(),Ge()}),(e,t)=>(b(),l("div",D,[i("div",N,[t[17]||(t[17]=i("div",{class:"mb-4"},[i("h1",{class:"text-lg font-bold text-gray-900"},"Expense Configuration"),i("p",{class:"text-xs text-gray-500"},"Manage expense categories and tags")],-1)),i("div",T,[i("div",null,[i("div",{class:"mb-2 flex justify-between items-center"},[t[7]||(t[7]=i("h2",{class:"text-sm font-semibold text-gray-900"},"Categories",-1)),i("button",{onClick:Ke,class:"px-2 py-1 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded"}," New Category ")]),i("div",I,[i("table",_,[t[11]||(t[11]=i("thead",{class:"bg-gray-50"},[i("tr",null,[i("th",{class:"px-2 py-1 text-left text-xs font-medium text-gray-500 uppercase"},"Name"),i("th",{class:"px-2 py-1 text-center text-xs font-medium text-gray-500 uppercase"},"Status"),i("th",{class:"px-2 py-1 text-center text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),i("tbody",U,[0===Te.value.length?(b(),l("tr",F,t[8]||(t[8]=[i("td",{colspan:"3",class:"px-2 py-4 text-center text-xs text-gray-500"}," No categories found ",-1)]))):n("",!0),(b(!0),l(r,null,o(Te.value,e=>(b(),l("tr",{key:e.ID,class:"hover:bg-gray-50"},[i("td",S,[i("div",V,d(e.name),1),e.description?(b(),l("div",E,d(e.description),1)):n("",!0)]),i("td",M,[i("span",{class:c([e.active?"text-green-600":"text-gray-400","text-xs font-medium"])},d(e.active?"Active":"Inactive"),3)]),i("td",A,[i("div",q,[i("button",{onClick:t=>function(e){_e.value=!0,Se.value=e,Ve.value={name:e.name,description:e.description,active:e.active},Fe.value="",Ie.value=!0}(e),class:"px-2 py-1 bg-sage text-white rounded hover:bg-sage-dark text-xs",title:"Edit"},t[9]||(t[9]=[i("i",{class:"fa fa-edit"},null,-1)]),8,B),i("button",{onClick:t=>async function(e){var t,a;if(confirm(`Delete category "${e.name}"? This cannot be undone.`))try{await w(e.ID),await Oe()}catch(s){alert((null==(a=null==(t=s.response)?void 0:t.data)?void 0:a.error)||"Failed to delete category")}}(e),class:"px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xs",title:"Delete"},t[10]||(t[10]=[i("i",{class:"fa fa-trash"},null,-1)]),8,$)])])]))),128))])])])]),i("div",null,[i("div",{class:"mb-2 flex justify-between items-center"},[t[12]||(t[12]=i("h2",{class:"text-sm font-semibold text-gray-900"},"Tags",-1)),i("button",{onClick:Re,class:"px-2 py-1 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded"}," New Tag ")]),i("div",z,[i("table",L,[t[16]||(t[16]=i("thead",{class:"bg-gray-50"},[i("tr",null,[i("th",{class:"px-2 py-1 text-left text-xs font-medium text-gray-500 uppercase"},"Name"),i("th",{class:"px-2 py-1 text-right text-xs font-medium text-gray-500 uppercase"},"Budget"),i("th",{class:"px-2 py-1 text-center text-xs font-medium text-gray-500 uppercase"},"Status"),i("th",{class:"px-2 py-1 text-center text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),i("tbody",O,[0===Ee.value.length?(b(),l("tr",G,t[13]||(t[13]=[i("td",{colspan:"4",class:"px-2 py-4 text-center text-xs text-gray-500"}," No tags found ",-1)]))):n("",!0),(b(!0),l(r,null,o(Ee.value,e=>{return b(),l("tr",{key:e.ID,class:"hover:bg-gray-50"},[i("td",H,[i("div",J,d(e.name),1),e.description?(b(),l("div",K,d(e.description),1)):n("",!0),e.budget?(b(),l("div",Q,[i("div",P,[i("div",{class:c(["h-1 rounded-full transition-all",(a=e.budget_percentage,a?a>=100?"bg-red-600":a>=90?"bg-orange-500":a>=75?"bg-yellow-500":"bg-green-500":"bg-green-500")]),style:u(`width: ${Math.min(e.budget_percentage??0,100)}%`)},null,6)]),i("div",R,[i("span",W,d(He(e.total_spent||0))+" / "+d(He(e.budget)),1),i("span",{class:c(Je(e))},d(e.budget_percentage)+"%",3)])])):n("",!0)]),i("td",X,d(e.budget?He(e.budget):"-"),1),i("td",Y,[i("span",{class:c([e.active?"text-green-600":"text-gray-400","text-xs font-medium"])},d(e.active?"Active":"Inactive"),3)]),i("td",Z,[i("div",ee,[i("button",{onClick:t=>function(e){Ae.value=!0,$e.value=e,ze.value={name:e.name,description:e.description,active:e.active,budget:e.budget},Be.value="",Me.value=!0}(e),class:"px-2 py-1 bg-sage text-white rounded hover:bg-sage-dark text-xs",title:"Edit"},t[14]||(t[14]=[i("i",{class:"fa fa-edit"},null,-1)]),8,te),i("button",{onClick:t=>async function(e){var t,a;if(confirm(`Delete tag "${e.name}"? This cannot be undone.`))try{await j(e.ID),await Ge()}catch(s){alert((null==(a=null==(t=s.response)?void 0:t.data)?void 0:a.error)||"Failed to delete tag. It may still be in use by expenses.")}}(e),class:"px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xs",title:"Delete"},t[15]||(t[15]=[i("i",{class:"fa fa-trash"},null,-1)]),8,ae)])])]);var a}),128))])])])])])]),Ie.value?(b(),l("div",se,[i("div",le,[i("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 backdrop-blur-sm transition-opacity",onClick:Qe}),i("div",ie,[i("div",ne,[i("h3",re,d(_e.value?"Edit Category":"New Category"),1),i("button",{onClick:Qe,class:"text-white hover:text-gray-200"},t[18]||(t[18]=[i("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),i("div",oe,[i("div",de,[i("div",null,[t[19]||(t[19]=i("label",{class:"block text-xs font-medium text-gray-700 mb-0.5"},[g(" Category Name "),i("span",{class:"text-red-500"},"*")],-1)),x(i("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>Ve.value.name=e),type:"text",required:"",placeholder:"e.g., Travel, Technology",class:"bg-white border border-gray-300 text-gray-900 text-xs rounded focus:ring-sage focus:border-sage block w-full p-1.5"},null,512),[[v,Ve.value.name]])]),i("div",null,[t[20]||(t[20]=i("label",{class:"block text-xs font-medium text-gray-700 mb-0.5"},"Description",-1)),x(i("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>Ve.value.description=e),rows:"2",placeholder:"Optional description",class:"bg-white border border-gray-300 text-gray-900 text-xs rounded focus:ring-sage focus:border-sage block w-full p-1.5"},null,512),[[v,Ve.value.description]])]),_e.value?(b(),l("div",ce,[i("label",ue,[x(i("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>Ve.value.active=e),type:"checkbox",class:"rounded border-gray-300 text-sage focus:ring-sage"},null,512),[[p,Ve.value.active]]),t[21]||(t[21]=i("span",{class:"ml-2 text-xs text-gray-700"},"Active",-1))])])):n("",!0),Fe.value?(b(),l("div",xe,d(Fe.value),1)):n("",!0)]),i("div",ge,[i("button",{onClick:Qe,class:"px-2.5 py-1 text-xs font-semibold text-gray-900 bg-white rounded shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"}," Cancel "),i("button",{onClick:Pe,disabled:Ue.value,class:"px-2.5 py-1 text-xs font-semibold text-white bg-sage rounded shadow-sm hover:bg-sage-dark disabled:opacity-50"},d(Ue.value?"Saving...":"Save"),9,ve)])])])])])):n("",!0),Me.value?(b(),l("div",pe,[i("div",be,[i("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 backdrop-blur-sm transition-opacity",onClick:We}),i("div",ye,[i("div",me,[i("h3",fe,d(Ae.value?"Edit Tag":"New Tag"),1),i("button",{onClick:We,class:"text-white hover:text-gray-200"},t[22]||(t[22]=[i("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),i("div",he,[i("div",we,[i("div",null,[t[23]||(t[23]=i("label",{class:"block text-xs font-medium text-gray-700 mb-0.5"},[g(" Tag Name "),i("span",{class:"text-red-500"},"*")],-1)),x(i("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>ze.value.name=e),type:"text",required:"",placeholder:"e.g., Offsite 2025, Q4 Campaign",class:"bg-white border border-gray-300 text-gray-900 text-xs rounded focus:ring-sage focus:border-sage block w-full p-1.5"},null,512),[[v,ze.value.name]])]),i("div",null,[t[24]||(t[24]=i("label",{class:"block text-xs font-medium text-gray-700 mb-0.5"},"Description",-1)),x(i("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>ze.value.description=e),rows:"2",placeholder:"Optional description",class:"bg-white border border-gray-300 text-gray-900 text-xs rounded focus:ring-sage focus:border-sage block w-full p-1.5"},null,512),[[v,ze.value.description]])]),i("div",null,[t[26]||(t[26]=i("label",{class:"block text-xs font-medium text-gray-700 mb-0.5"},"Budget (optional)",-1)),i("div",ke,[t[25]||(t[25]=i("span",{class:"flex items-center px-2 text-gray-500 text-xs bg-gray-50 border-r border-gray-300"},"$",-1)),x(i("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>Le.value=e),type:"number",step:"0.01",min:"0",placeholder:"0.00",class:"flex-1 text-gray-900 text-xs p-1.5 focus:outline-none border-0"},null,512),[[v,Le.value,void 0,{number:!0}]])]),t[27]||(t[27]=i("p",{class:"mt-1 text-xs text-gray-500"},"Leave empty for no budget tracking",-1))]),i("div",null,[i("label",Ce,[x(i("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>ze.value.active=e),type:"checkbox",class:"rounded border-gray-300 text-sage focus:ring-sage"},null,512),[[p,ze.value.active]]),t[28]||(t[28]=i("span",{class:"ml-2 text-xs text-gray-700"},"Active (can be used for new expenses)",-1))])]),Be.value?(b(),l("div",je,d(Be.value),1)):n("",!0)]),i("div",De,[i("button",{onClick:We,class:"px-2.5 py-1 text-xs font-semibold text-gray-900 bg-white rounded shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"}," Cancel "),i("button",{onClick:Xe,disabled:qe.value,class:"px-2.5 py-1 text-xs font-semibold text-white bg-sage rounded shadow-sm hover:bg-sage-dark disabled:opacity-50"},d(qe.value?"Saving...":"Save"),9,Ne)])])])])])):n("",!0)]))}});export{Te as default};
